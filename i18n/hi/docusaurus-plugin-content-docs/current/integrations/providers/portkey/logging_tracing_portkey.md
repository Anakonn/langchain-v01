---
translated: true
---

# рд▓реЙрдЧ, рдЯреНрд░реЗрд╕ рдФрд░ рдореЙрдирд┐рдЯрд░ рдХрд░рдирд╛

рдЬрдм рдЖрдк рд▓реИрдВрдЧрдЪреЗрди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдРрдкреНрд╕ рдпрд╛ рдПрдЬреЗрдВрдЯ рдмрдирд╛ рд░рд╣реЗ рд╣реЛрддреЗ рд╣реИрдВ, рддреЛ рдПрдХ рд╣реА рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЕрдиреБрд░реЛрдз рдХреЛ рдкреВрд░рд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдк рдХрдИ API рдХреЙрд▓ рдХрд░рддреЗ рд╣реИрдВред рд╣рд╛рд▓рд╛рдВрдХрд┐, рдЬрдм рдЖрдк рдЗрди рдЕрдиреБрд░реЛрдзреЛрдВ рдХрд╛ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ, рддреЛ рдпреЗ рдЕрдиреБрд░реЛрдз рдЪреЗрди рдирд╣реАрдВ рд╣реЛрддреЗ рд╣реИрдВред [**Portkey**](/docs/integrations/providers/portkey/) рдХреЗ рд╕рд╛рде, рдПрдХ рд╣реА рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЕрдиреБрд░реЛрдз рд╕реЗ рд╕рдВрдмрдВрдзрд┐рдд рд╕рднреА рдПрдореНрдмреЗрдбрд┐рдВрдЧ, рдкреВрд░реНрдгрддрд╛ рдФрд░ рдЕрдиреНрдп рдЕрдиреБрд░реЛрдз рд▓реЙрдЧ рдФрд░ рдЯреНрд░реЗрд╕ рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВ, рдЬрд┐рд╕рд╕реЗ рдЖрдк рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЗрдВрдЯрд░реИрдХреНрд╢рди рдХреА рдкреВрд░реА рдЬрд╛рдирдХрд╛рд░реА рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

рдпрд╣ рдиреЛрдЯрдмреБрдХ рд▓реИрдВрдЧрдЪреЗрди LLM рдХреЙрд▓ рдХреЛ `Portkey` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд▓реЙрдЧ, рдЯреНрд░реЗрд╕ рдФрд░ рдореЙрдирд┐рдЯрд░ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЪрд░рдг-рджрд░-рдЪрд░рдг рдорд╛рд░реНрдЧрджрд░реНрд╢рд┐рдХрд╛ рд╣реИред

рдкрд╣рд▓реЗ, рдЖрдЗрдП Portkey, OpenAI рдФрд░ рдПрдЬреЗрдВрдЯ рдЯреВрд▓ рдЖрдпрд╛рдд рдХрд░рддреЗ рд╣реИрдВред

```python
import os

from langchain.agents import AgentExecutor, create_openai_tools_agent
from langchain_openai import ChatOpenAI
from portkey_ai import PORTKEY_GATEWAY_URL, createHeaders
```

рдиреАрдЪреЗ рдЕрдкрдирд╛ OpenAI API рдХреБрдВрдЬреА рджрд░реНрдЬ рдХрд░реЗрдВред [(рдЖрдк рдЗрд╕реЗ рдпрд╣рд╛рдВ рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВ)](https://platform.openai.com/account/api-keys)

```python
os.environ["OPENAI_API_KEY"] = "..."
```

## Portkey API рдХреБрдВрдЬреА рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ

1. [рдпрд╣рд╛рдВ Portkey рдХреЗ рд▓рд┐рдП рд╕рд╛рдЗрди рдЕрдк рдХрд░реЗрдВ](https://app.portkey.ai/signup)
2. рдЕрдкрдиреЗ [рдбреИрд╢рдмреЛрд░реНрдб](https://app.portkey.ai/) рдкрд░, рдиреАрдЪреЗ рдмрд╛рдПрдВ рдХреЛрдиреЗ рдкрд░ рдкреНрд░реЛрдлрд╝рд╛рдЗрд▓ рдЖрдЗрдХрди рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░реЗрдВ, рдлрд┐рд░ "API рдХреБрдВрдЬреА рдХреЙрдкреА рдХрд░реЗрдВ" рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░реЗрдВ
3. рдЗрд╕реЗ рдиреАрдЪреЗ рдЪрд┐рдкрдХрд╛рдПрдВ

```python
PORTKEY_API_KEY = "..."  # Paste your Portkey API Key here
```

## рдЯреНрд░реЗрд╕ рдЖрдИрдбреА рд╕реЗрдЯ рдХрд░реЗрдВ

1. рдиреАрдЪреЗ рдЕрдкрдиреЗ рдЕрдиреБрд░реЛрдз рдХреЗ рд▓рд┐рдП рдЯреНрд░реЗрд╕ рдЖрдИрдбреА рд╕реЗрдЯ рдХрд░реЗрдВ
2. рдЯреНрд░реЗрд╕ рдЖрдИрдбреА рдПрдХ рд╣реА рдЕрдиреБрд░реЛрдз рд╕реЗ рдЙрддреНрдкрдиреНрди рд╕рднреА API рдХреЙрд▓ рдХреЗ рд▓рд┐рдП рд╕рдорд╛рди рд╣реЛ рд╕рдХрддрд╛ рд╣реИ

```python
TRACE_ID = "uuid-trace-id"  # Set trace id here
```

## Portkey рд╣реЗрдбрд░ рдЬрдирд░реЗрдЯ рдХрд░реЗрдВ

```python
portkey_headers = createHeaders(
    api_key=PORTKEY_API_KEY, provider="openai", trace_id=TRACE_ID
)
```

рдкреНрд░реЛрдореНрдкреНрдЯ рдФрд░ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдХрд░рдг рдХреЛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░реЗрдВ

```python
from langchain import hub
from langchain_core.tools import tool

prompt = hub.pull("hwchase17/openai-tools-agent")


@tool
def multiply(first_int: int, second_int: int) -> int:
    """Multiply two integers together."""
    return first_int * second_int


@tool
def exponentiate(base: int, exponent: int) -> int:
    "Exponentiate the base to the exponent power."
    return base**exponent


tools = [multiply, exponentiate]
```

рдЕрдкрдиреЗ рдПрдЬреЗрдВрдЯ рдХреЛ рд╕рд╛рдорд╛рдиреНрдп рд░реВрдк рд╕реЗ рдЪрд▓рд╛рдПрдВред **рдПрдХрдорд╛рддреНрд░** рдмрджрд▓рд╛рд╡ рдпрд╣ рд╣реИ рдХрд┐ рд╣рдо рдЕрдм **рдЙрдкрд░реЛрдХреНрдд рд╣реЗрдбрд░** рдХреЛ рдЕрдиреБрд░реЛрдз рдореЗрдВ рд╢рд╛рдорд┐рд▓ рдХрд░реЗрдВрдЧреЗред

```python
model = ChatOpenAI(
    base_url=PORTKEY_GATEWAY_URL, default_headers=portkey_headers, temperature=0
)

# Construct the OpenAI Tools agent
agent = create_openai_tools_agent(model, tools, prompt)

# Create an agent executor by passing in the agent and tools
agent_executor = AgentExecutor(agent=agent, tools=tools, verbose=True)

agent_executor.invoke(
    {
        "input": "Take 3 to the fifth power and multiply that by thirty six, then square the result"
    }
)
```

```output


[1m> Entering new AgentExecutor chain...[0m
[32;1m[1;3m
Invoking: `exponentiate` with `{'base': 3, 'exponent': 5}`


[0m[33;1m[1;3m243[0m[32;1m[1;3m
Invoking: `multiply` with `{'first_int': 243, 'second_int': 36}`


[0m[36;1m[1;3m8748[0m[32;1m[1;3m
Invoking: `exponentiate` with `{'base': 8748, 'exponent': 2}`


[0m[33;1m[1;3m76527504[0m[32;1m[1;3mThe result of taking 3 to the fifth power, multiplying it by 36, and then squaring the result is 76,527,504.[0m

[1m> Finished chain.[0m
```

```output
{'input': 'Take 3 to the fifth power and multiply that by thirty six, then square the result',
 'output': 'The result of taking 3 to the fifth power, multiplying it by 36, and then squaring the result is 76,527,504.'}
```

## Portkey рдкрд░ рд▓реЙрдЧрд┐рдВрдЧ рдФрд░ рдЯреНрд░реЗрд╕рд┐рдВрдЧ рдХреИрд╕реЗ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИ

**рд▓реЙрдЧрд┐рдВрдЧ**
- Portkey рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдЕрдкрдирд╛ рдЕрдиреБрд░реЛрдз рднреЗрдЬрдирд╛ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рддрд╛ рд╣реИ рдХрд┐ рд╕рднреА рдЕрдиреБрд░реЛрдз рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ рд▓реЙрдЧ рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВ
- рдкреНрд░рддреНрдпреЗрдХ рдЕрдиреБрд░реЛрдз рд▓реЙрдЧ рдореЗрдВ `timestamp`, `model name`, `total cost`, `request time`, `request json`, `response json`, рдФрд░ рдЕрддрд┐рд░рд┐рдХреНрдд Portkey рд╕реБрд╡рд┐рдзрд╛рдПрдВ рд╢рд╛рдорд┐рд▓ рд╣реЛрддреА рд╣реИрдВ

**[рдЯреНрд░реЗрд╕рд┐рдВрдЧ](https://portkey.ai/docs/product/observability-modern-monitoring-for-llms/traces)**
- рдЯреНрд░реЗрд╕ рдЖрдИрдбреА рдХреЛ рдкреНрд░рддреНрдпреЗрдХ рдЕрдиреБрд░реЛрдз рдХреЗ рд╕рд╛рде рдкрд╛рд╕ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдФрд░ рдпрд╣ Portkey рдбреИрд╢рдмреЛрд░реНрдб рдкрд░ рд▓реЙрдЧ рдкрд░ рджрд┐рдЦрд╛рдИ рджреЗрддрд╛ рд╣реИ
- рдЖрдк рдкреНрд░рддреНрдпреЗрдХ рдЕрдиреБрд░реЛрдз рдХреЗ рд▓рд┐рдП **рдЕрд▓рдЧ-рдЕрд▓рдЧ рдЯреНрд░реЗрд╕ рдЖрдИрдбреА** рднреА рд╕реЗрдЯ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ
- рдЖрдк рдЯреНрд░реЗрд╕ рдЖрдИрдбреА рдХреЗ рд╕рд╛рде рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рднреА рдЬреЛрдбрд╝ рд╕рдХрддреЗ рд╣реИрдВред [рдЗрд╕ рдмрд╛рд░реЗ рдореЗрдВ рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдпрд╣рд╛рдВ рд╣реИ](https://portkey.ai/docs/product/observability-modern-monitoring-for-llms/feedback)

рдЙрдкрд░реЛрдХреНрдд рдЕрдиреБрд░реЛрдз рдХреЗ рд▓рд┐рдП, рдЖрдк рдкреВрд░реЗ рд▓реЙрдЧ рдЯреНрд░реЗрд╕ рдХреЛ рдЗрд╕ рдкреНрд░рдХрд╛рд░ рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ
![View Langchain traces on Portkey](https://assets.portkey.ai/docs/agent_tracing.gif)

## рдЙрдиреНрдирдд LLMOps рд╕реБрд╡рд┐рдзрд╛рдПрдВ - рдХреИрд╢рд┐рдВрдЧ, рдЯреИрдЧрд┐рдВрдЧ, рд░реАрдЯреНрд░рд╛рдЗрдЬ

рд▓реЙрдЧрд┐рдВрдЧ рдФрд░ рдЯреНрд░реЗрд╕рд┐рдВрдЧ рдХреЗ рдЕрд▓рд╛рд╡рд╛, Portkey рдФрд░ рднреА рдХрдИ рд╕реБрд╡рд┐рдзрд╛рдПрдВ рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИ рдЬреЛ рдЖрдкрдХреЗ рдореМрдЬреВрджрд╛ рдХрд╛рд░реНрдпрдкреНрд░рд╡рд╛рд╣реЛрдВ рдореЗрдВ рдЙрддреНрдкрд╛рджрди рдХреНрд╖рдорддрд╛рдПрдВ рдЬреЛрдбрд╝рддреА рд╣реИрдВ:

**рдХреИрд╢рд┐рдВрдЧ**

рдкрд╣рд▓реЗ рд╕реЗ рд╕рд░реНрд╡ рдХрд┐рдП рдЧрдП рдЧреНрд░рд╛рд╣рдХреЛрдВ рдХреЗ рдкреНрд░рд╢реНрдиреЛрдВ рдХреЛ рдХреИрд╢ рд╕реЗ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рджреЗрдВ рдмрдЬрд╛рдп рдЙрдиреНрд╣реЗрдВ рдлрд┐рд░ рд╕реЗ OpenAI рдХреЛ рднреЗрдЬреЗрдВред рд╕рдЯреАрдХ рд╕реНрдЯреНрд░рд┐рдВрдЧ рдпрд╛ semantically рд╕рдорд╛рди рд╕реНрдЯреНрд░рд┐рдВрдЧ рдореИрдЪ рдХрд░реЗрдВред рдХреИрд╢ рд▓рд╛рдЧрдд рдФрд░ рд▓реЗрдЯреЗрдВрд╕реА рдХреЛ 20 рдЧреБрдирд╛ рддрдХ рдХрдо рдХрд░ рд╕рдХрддрд╛ рд╣реИред [рджрд╕реНрддрд╛рд╡реЗрдЬрд╝](https://portkey.ai/docs/product/ai-gateway-streamline-llm-integrations/cache-simple-and-semantic)

**рд░реАрдЯреНрд░рд╛рдЗрдЬ**

рдХрд┐рд╕реА рднреА рдЕрд╕рдлрд▓ API рдЕрдиреБрд░реЛрдз рдХреЛ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ **`5 рдмрд╛рд░ рддрдХ`** рдкреБрдирдГ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХрд░реЗрдВред **`рдПрдХреНрд╕рдкреЛрдиреЗрдВрд╢рд┐рдпрд▓ рдмреИрдХрдСрдл`** рд░рдгрдиреАрддрд┐ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ, рдЬреЛ рдиреЗрдЯрд╡рд░реНрдХ рдУрд╡рд░рд▓реЛрдб рдХреЛ рд░реЛрдХрдиреЗ рдХреЗ рд▓рд┐рдП рд░реАрдЯреНрд░рд╛рдИ рдкреНрд░рдпрд╛рд╕реЛрдВ рдХреЛ рдЕрд▓рдЧ-рдЕрд▓рдЧ рдХрд░рддрд╛ рд╣реИред [рджрд╕реНрддрд╛рд╡реЗрдЬрд╝](https://portkey.ai/docs/product/ai-gateway-streamline-llm-integrations)

**рдЯреИрдЧрд┐рдВрдЧ**

рдкреВрд░реНрд╡-рдкрд░рд┐рднрд╛рд╖рд┐рдд рдЯреИрдЧ рдХреЗ рд╕рд╛рде рдкреНрд░рддреНрдпреЗрдХ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЗрдВрдЯрд░реИрдХреНрд╢рди рдХреЛ рд╡рд┐рд╕реНрддреГрдд рд░реВрдк рд╕реЗ рдЯреНрд░реИрдХ рдФрд░ рдСрдбрд┐рдЯ рдХрд░реЗрдВред [рджрд╕реНрддрд╛рд╡реЗрдЬрд╝](https://portkey.ai/docs/product/observability-modern-monitoring-for-llms/metadata)
