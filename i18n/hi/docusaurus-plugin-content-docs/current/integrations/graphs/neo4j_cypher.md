---
translated: true
---

# Neo4j

>[Neo4j](https://neo4j.com/docs/getting-started/) ‡§è‡§ï ‡§ó‡•ç‡§∞‡§æ‡§´‡§º ‡§°‡•á‡§ü‡§æ‡§¨‡•á‡§∏ ‡§™‡•ç‡§∞‡§¨‡§Ç‡§ß‡§® ‡§™‡•ç‡§∞‡§£‡§æ‡§≤‡•Ä ‡§π‡•à ‡§ú‡§ø‡§∏‡•á `Neo4j, Inc` ‡§¶‡•ç‡§µ‡§æ‡§∞‡§æ ‡§µ‡§ø‡§ï‡§∏‡§ø‡§§ ‡§ï‡§ø‡§Ø‡§æ ‡§ó‡§Ø‡§æ ‡§π‡•à‡•§

>`Neo4j` ‡§¶‡•ç‡§µ‡§æ‡§∞‡§æ ‡§∏‡§Ç‡§ó‡•ç‡§∞‡§π‡§ø‡§§ ‡§°‡•á‡§ü‡§æ ‡§§‡§§‡•ç‡§µ ‡§®‡•ã‡§°, ‡§â‡§®‡•ç‡§π‡•á‡§Ç ‡§ú‡•ã‡§°‡§º‡§®‡•á ‡§µ‡§æ‡§≤‡•á ‡§ï‡§ø‡§®‡§æ‡§∞‡•á ‡§î‡§∞ ‡§®‡•ã‡§° ‡§î‡§∞ ‡§ï‡§ø‡§®‡§æ‡§∞‡•ã‡§Ç ‡§ï‡•á ‡§ó‡•Å‡§£ ‡§π‡•à‡§Ç‡•§ ‡§Ö‡§™‡§®‡•á ‡§µ‡§ø‡§ï‡§æ‡§∏‡§ï‡§∞‡•ç‡§§‡§æ‡§ì‡§Ç ‡§¶‡•ç‡§µ‡§æ‡§∞‡§æ ‡§è‡§∏‡§ø‡§°-‡§Ö‡§®‡•Å‡§™‡§æ‡§≤‡§® ‡§µ‡§æ‡§≤‡•á ‡§≤‡•á‡§®‡§¶‡•á‡§® ‡§°‡•á‡§ü‡§æ‡§¨‡•á‡§∏ ‡§ï‡•á ‡§∞‡•Ç‡§™ ‡§Æ‡•á‡§Ç ‡§µ‡§∞‡•ç‡§£‡§ø‡§§, ‡§ú‡§ø‡§∏‡§Æ‡•á‡§Ç ‡§®‡•á‡§ü‡§ø‡§µ ‡§ó‡•ç‡§∞‡§æ‡§´‡§º ‡§∏‡§Ç‡§ó‡•ç‡§∞‡§π‡§£ ‡§î‡§∞ ‡§™‡•ç‡§∞‡§∏‡§Ç‡§∏‡•ç‡§ï‡§∞‡§£ ‡§π‡•à, `Neo4j` ‡§è‡§ï ‡§ó‡•à‡§∞-‡§ì‡§™‡§®-‡§∏‡•ã‡§∞‡•ç‡§∏ "‡§ï‡§Æ‡•ç‡§Ø‡•Å‡§®‡§ø‡§ü‡•Ä ‡§∏‡§Ç‡§∏‡•ç‡§ï‡§∞‡§£" ‡§Æ‡•á‡§Ç ‡§â‡§™‡§≤‡§¨‡•ç‡§ß ‡§π‡•à ‡§ú‡§ø‡§∏‡•á GNU ‡§ú‡§®‡§∞‡§≤ ‡§™‡§¨‡•ç‡§≤‡§ø‡§ï ‡§≤‡§æ‡§á‡§∏‡•á‡§Ç‡§∏ ‡§ï‡•á ‡§∏‡§Ç‡§∂‡•ã‡§ß‡§® ‡§ï‡•á ‡§∏‡§æ‡§• ‡§≤‡§æ‡§á‡§∏‡•á‡§Ç‡§∏ ‡§¶‡§ø‡§Ø‡§æ ‡§ó‡§Ø‡§æ ‡§π‡•à, ‡§ë‡§®‡§≤‡§æ‡§á‡§® ‡§¨‡•à‡§ï‡§Ö‡§™ ‡§î‡§∞ ‡§â‡§ö‡•ç‡§ö ‡§â‡§™‡§≤‡§¨‡•ç‡§ß‡§§‡§æ ‡§µ‡§ø‡§∏‡•ç‡§§‡§æ‡§∞‡•ã‡§Ç ‡§ï‡•á ‡§∏‡§æ‡§• ‡§ú‡•ã ‡§¨‡§Ç‡§¶ ‡§∏‡•ç‡§∞‡•ã‡§§ ‡§µ‡§æ‡§£‡§ø‡§ú‡•ç‡§Ø‡§ø‡§ï ‡§≤‡§æ‡§á‡§∏‡•á‡§Ç‡§∏ ‡§ï‡•á ‡§§‡§π‡§§ ‡§≤‡§æ‡§á‡§∏‡•á‡§Ç‡§∏ ‡§¶‡§ø‡§è ‡§ó‡§è ‡§π‡•à‡§Ç‡•§ ‡§®‡§ø‡§Ø‡•ã ‡§≠‡•Ä ‡§á‡§® ‡§µ‡§ø‡§∏‡•ç‡§§‡§æ‡§∞‡•ã‡§Ç ‡§ï‡•á ‡§∏‡§æ‡§• `Neo4j` ‡§ï‡•ã ‡§¨‡§Ç‡§¶ ‡§∏‡•ç‡§∞‡•ã‡§§ ‡§µ‡§æ‡§£‡§ø‡§ú‡•ç‡§Ø‡§ø‡§ï ‡§∂‡§∞‡•ç‡§§‡•ã‡§Ç ‡§ï‡•á ‡§§‡§π‡§§ ‡§≤‡§æ‡§á‡§∏‡•á‡§Ç‡§∏ ‡§¶‡•á‡§§‡§æ ‡§π‡•à‡•§

>‡§Ø‡§π ‡§®‡•ã‡§ü‡§¨‡•Å‡§ï ‡§¶‡§ø‡§ñ‡§æ‡§§‡§æ ‡§π‡•à ‡§ï‡§ø ‡§ï‡•à‡§∏‡•á ‡§è‡§≤‡§è‡§≤‡§è‡§Æ ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡§ï‡•á ‡§è‡§ï ‡§ó‡•ç‡§∞‡§æ‡§´‡§º ‡§°‡•á‡§ü‡§æ‡§¨‡•á‡§∏ ‡§ï‡•á ‡§≤‡§ø‡§è ‡§è‡§ï ‡§™‡•ç‡§∞‡§æ‡§ï‡•É‡§§‡§ø‡§ï ‡§≠‡§æ‡§∑‡§æ ‡§á‡§Ç‡§ü‡§∞‡§´‡§º‡•á‡§∏ ‡§™‡•ç‡§∞‡§¶‡§æ‡§® ‡§ï‡§ø‡§Ø‡§æ ‡§ú‡§æ ‡§∏‡§ï‡§§‡§æ ‡§π‡•à ‡§ú‡§ø‡§∏‡•á ‡§Ü‡§™ `Cypher` ‡§ï‡•ç‡§µ‡•á‡§∞‡•Ä ‡§≠‡§æ‡§∑‡§æ ‡§ï‡•á ‡§∏‡§æ‡§• ‡§ï‡•ç‡§µ‡•á‡§∞‡•Ä ‡§ï‡§∞ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç‡•§

>[Cypher](https://en.wikipedia.org/wiki/Cypher_(query_language)) ‡§è‡§ï ‡§ò‡•ã‡§∑‡§£‡§æ‡§§‡•ç‡§Æ‡§ï ‡§ó‡•ç‡§∞‡§æ‡§´‡§º ‡§ï‡•ç‡§µ‡•á‡§∞‡•Ä ‡§≠‡§æ‡§∑‡§æ ‡§π‡•à ‡§ú‡•ã ‡§∏‡§Ç‡§™‡§§‡•ç‡§§‡§ø ‡§ó‡•ç‡§∞‡§æ‡§´‡§º ‡§Æ‡•á‡§Ç ‡§™‡•ç‡§∞‡§≠‡§æ‡§µ‡•Ä ‡§î‡§∞ ‡§ï‡•Å‡§∂‡§≤ ‡§°‡•á‡§ü‡§æ ‡§ï‡•ç‡§µ‡•á‡§∞‡•Ä ‡§ï‡§∞‡§®‡•á ‡§ï‡•Ä ‡§Ö‡§≠‡§ø‡§µ‡•ç‡§Ø‡§ï‡•ç‡§§‡§ø ‡§ï‡•Ä ‡§Ö‡§®‡•Å‡§Æ‡§§‡§ø ‡§¶‡•á‡§§‡§æ ‡§π‡•à‡•§

## ‡§∏‡•á‡§ü‡§Ö‡§™ ‡§ï‡§∞‡§®‡§æ

‡§Ü‡§™‡§ï‡•ã ‡§è‡§ï ‡§ö‡§≤ ‡§∞‡§π‡•á `Neo4j` ‡§á‡§Ç‡§∏‡•ç‡§ü‡•á‡§Ç‡§∏ ‡§π‡•ã‡§®‡§æ ‡§ö‡§æ‡§π‡§ø‡§è‡•§ ‡§è‡§ï ‡§µ‡§ø‡§ï‡§≤‡•ç‡§™ [Neo4j ‡§ï‡•á Aura ‡§ï‡•ç‡§≤‡§æ‡§â‡§° ‡§∏‡•á‡§µ‡§æ ‡§Æ‡•á‡§Ç ‡§è‡§ï ‡§Æ‡•Å‡§´‡•ç‡§§ Neo4j ‡§°‡•á‡§ü‡§æ‡§¨‡•á‡§∏ ‡§á‡§Ç‡§∏‡•ç‡§ü‡•á‡§Ç‡§∏ ‡§¨‡§®‡§æ‡§®‡§æ](https://neo4j.com/cloud/platform/aura-graph-database/) ‡§π‡•à‡•§ ‡§Ü‡§™ [Neo4j ‡§°‡•á‡§∏‡•ç‡§ï‡§ü‡•â‡§™ ‡§è‡§™‡•ç‡§≤‡§ø‡§ï‡•á‡§∂‡§®](https://neo4j.com/download/) ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡§ï‡•á ‡§Ø‡§æ ‡§è‡§ï ‡§°‡•â‡§ï‡§∞ ‡§ï‡§Ç‡§ü‡•á‡§®‡§∞ ‡§ö‡§≤‡§æ‡§ï‡§∞ ‡§≠‡•Ä ‡§°‡•á‡§ü‡§æ‡§¨‡•á‡§∏ ‡§ï‡•ã ‡§∏‡•ç‡§•‡§æ‡§®‡•Ä‡§Ø ‡§∞‡•Ç‡§™ ‡§∏‡•á ‡§ö‡§≤‡§æ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç‡•§
‡§Ü‡§™ ‡§®‡§ø‡§Æ‡•ç‡§®‡§≤‡§ø‡§ñ‡§ø‡§§ ‡§∏‡•ç‡§ï‡•ç‡§∞‡§ø‡§™‡•ç‡§ü ‡§ï‡•ã ‡§®‡§ø‡§∑‡•ç‡§™‡§æ‡§¶‡§ø‡§§ ‡§ï‡§∞‡§ï‡•á ‡§è‡§ï ‡§∏‡•ç‡§•‡§æ‡§®‡•Ä‡§Ø ‡§°‡•â‡§ï‡§∞ ‡§ï‡§Ç‡§ü‡•á‡§®‡§∞ ‡§ö‡§≤‡§æ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç:

```bash
docker run \
    --name neo4j \
    -p 7474:7474 -p 7687:7687 \
    -d \
    -e NEO4J_AUTH=neo4j/password \
    -e NEO4J_PLUGINS=\[\"apoc\"\]  \
    neo4j:latest
```

‡§Ø‡§¶‡§ø ‡§Ü‡§™ ‡§°‡•â‡§ï‡§∞ ‡§ï‡§Ç‡§ü‡•á‡§®‡§∞ ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞ ‡§∞‡§π‡•á ‡§π‡•à‡§Ç, ‡§§‡•ã ‡§°‡•á‡§ü‡§æ‡§¨‡•á‡§∏ ‡§∂‡•Å‡§∞‡•Ç ‡§π‡•ã‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§ï‡•Å‡§õ ‡§∏‡•á‡§ï‡§Ç‡§° ‡§™‡•ç‡§∞‡§§‡•Ä‡§ï‡•ç‡§∑‡§æ ‡§ï‡§∞‡§®‡•Ä ‡§π‡•ã‡§ó‡•Ä‡•§

```python
from langchain.chains import GraphCypherQAChain
from langchain_community.graphs import Neo4jGraph
from langchain_openai import ChatOpenAI
```

```python
graph = Neo4jGraph(url="bolt://localhost:7687", username="neo4j", password="password")
```

## ‡§°‡•á‡§ü‡§æ‡§¨‡•á‡§∏ ‡§ï‡•ã ‡§∏‡•Ä‡§° ‡§ï‡§∞‡§®‡§æ

‡§Ø‡§π ‡§Æ‡§æ‡§®‡§§‡•á ‡§π‡•Å‡§è ‡§ï‡§ø ‡§Ü‡§™‡§ï‡§æ ‡§°‡•á‡§ü‡§æ‡§¨‡•á‡§∏ ‡§ñ‡§æ‡§≤‡•Ä ‡§π‡•à, ‡§Ü‡§™ Cypher ‡§ï‡•ç‡§µ‡•á‡§∞‡•Ä ‡§≠‡§æ‡§∑‡§æ ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡§ï‡•á ‡§á‡§∏‡•á ‡§≠‡§∞ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç‡•§ ‡§®‡§ø‡§Æ‡•ç‡§®‡§≤‡§ø‡§ñ‡§ø‡§§ Cypher ‡§¨‡§Ø‡§æ‡§® ‡§Ö‡§ï‡•ç‡§∑‡§Æ ‡§π‡•à, ‡§ú‡§ø‡§∏‡§ï‡§æ ‡§Ö‡§∞‡•ç‡§• ‡§π‡•à ‡§ï‡§ø ‡§Ü‡§™ ‡§á‡§∏‡•á ‡§è‡§ï ‡§Ø‡§æ ‡§è‡§ï ‡§∏‡•á ‡§Ö‡§ß‡§ø‡§ï ‡§¨‡§æ‡§∞ ‡§ö‡§≤‡§æ‡§®‡•á ‡§™‡§∞ ‡§≠‡•Ä ‡§°‡•á‡§ü‡§æ‡§¨‡•á‡§∏ ‡§ú‡§æ‡§®‡§ï‡§æ‡§∞‡•Ä ‡§∏‡§Æ‡§æ‡§® ‡§π‡•ã‡§ó‡•Ä‡•§

```python
graph.query(
    """
MERGE (m:Movie {name:"Top Gun", runtime: 120})
WITH m
UNWIND ["Tom Cruise", "Val Kilmer", "Anthony Edwards", "Meg Ryan"] AS actor
MERGE (a:Actor {name:actor})
MERGE (a)-[:ACTED_IN]->(m)
"""
)
```

```output
[]
```

## ‡§ó‡•ç‡§∞‡§æ‡§´‡§º ‡§∏‡•ç‡§ï‡•Ä‡§Æ‡§æ ‡§ú‡§æ‡§®‡§ï‡§æ‡§∞‡•Ä ‡§§‡§æ‡§ú‡§º‡§æ ‡§ï‡§∞‡•á‡§Ç

‡§Ø‡§¶‡§ø ‡§°‡•á‡§ü‡§æ‡§¨‡•á‡§∏ ‡§ï‡•Ä ‡§∏‡•ç‡§ï‡•Ä‡§Æ‡§æ ‡§Æ‡•á‡§Ç ‡§™‡§∞‡§ø‡§µ‡§∞‡•ç‡§§‡§® ‡§π‡•ã‡§§‡§æ ‡§π‡•à, ‡§§‡•ã ‡§Ü‡§™ Cypher ‡§¨‡§Ø‡§æ‡§® ‡§ú‡§®‡§∞‡•á‡§ü ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§Ü‡§µ‡§∂‡•ç‡§Ø‡§ï ‡§∏‡•ç‡§ï‡•Ä‡§Æ‡§æ ‡§ú‡§æ‡§®‡§ï‡§æ‡§∞‡•Ä ‡§§‡§æ‡§ú‡§º‡§æ ‡§ï‡§∞ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç‡•§

```python
graph.refresh_schema()
```

```python
print(graph.schema)
```

```output
Node properties:
Movie {runtime: INTEGER, name: STRING}
Actor {name: STRING}
Relationship properties:

The relationships:
(:Actor)-[:ACTED_IN]->(:Movie)
```

## ‡§¨‡•á‡§π‡§§‡§∞ ‡§∏‡•ç‡§ï‡•Ä‡§Æ‡§æ ‡§ú‡§æ‡§®‡§ï‡§æ‡§∞‡•Ä

‡§¨‡•á‡§π‡§§‡§∞ ‡§∏‡•ç‡§ï‡•Ä‡§Æ‡§æ ‡§∏‡§Ç‡§∏‡•ç‡§ï‡§∞‡§£ ‡§ö‡•Å‡§®‡§®‡•á ‡§∏‡•á ‡§™‡•ç‡§∞‡§£‡§æ‡§≤‡•Ä ‡§ï‡•ã ‡§°‡•á‡§ü‡§æ‡§¨‡•á‡§∏ ‡§ï‡•á ‡§≠‡•Ä‡§§‡§∞ ‡§â‡§¶‡§æ‡§π‡§∞‡§£ ‡§Æ‡•Ç‡§≤‡•ç‡§Ø‡•ã‡§Ç ‡§ï‡•Ä ‡§∏‡•ç‡§µ‡§ö‡§æ‡§≤‡§ø‡§§ ‡§∏‡•ç‡§ï‡•à‡§®‡§ø‡§Ç‡§ó ‡§î‡§∞ ‡§ï‡•Å‡§õ ‡§µ‡§ø‡§§‡§∞‡§£ ‡§Æ‡•Ä‡§ü‡•ç‡§∞‡§ø‡§ï‡•ç‡§∏ ‡§ï‡•Ä ‡§ó‡§£‡§®‡§æ ‡§ï‡§∞‡§®‡•á ‡§Æ‡•á‡§Ç ‡§∏‡§ï‡•ç‡§∑‡§Æ ‡§¨‡§®‡§æ‡§§‡§æ ‡§π‡•à‡•§ ‡§â‡§¶‡§æ‡§π‡§∞‡§£ ‡§ï‡•á ‡§≤‡§ø‡§è, ‡§Ø‡§¶‡§ø ‡§è‡§ï ‡§®‡•ã‡§° ‡§ó‡•Å‡§£ ‡§Æ‡•á‡§Ç 10 ‡§∏‡•á ‡§ï‡§Æ ‡§Ö‡§≤‡§ó ‡§Æ‡•Ç‡§≤‡•ç‡§Ø ‡§π‡•à‡§Ç, ‡§§‡•ã ‡§π‡§Æ ‡§∏‡•ç‡§ï‡•Ä‡§Æ‡§æ ‡§Æ‡•á‡§Ç ‡§∏‡§≠‡•Ä ‡§∏‡§Ç‡§≠‡§µ ‡§Æ‡•Ç‡§≤‡•ç‡§Ø ‡§µ‡§æ‡§™‡§∏ ‡§ï‡§∞‡§§‡•á ‡§π‡•à‡§Ç‡•§ ‡§Ö‡§®‡•ç‡§Ø‡§•‡§æ, ‡§™‡•ç‡§∞‡§§‡•ç‡§Ø‡•á‡§ï ‡§®‡•ã‡§° ‡§î‡§∞ ‡§∏‡§Ç‡§¨‡§Ç‡§ß ‡§ó‡•Å‡§£ ‡§ï‡•á ‡§≤‡§ø‡§è ‡§ï‡•á‡§µ‡§≤ ‡§è‡§ï ‡§â‡§¶‡§æ‡§π‡§∞‡§£ ‡§Æ‡•Ç‡§≤‡•ç‡§Ø ‡§µ‡§æ‡§™‡§∏ ‡§ï‡§∞‡§§‡•á ‡§π‡•à‡§Ç‡•§

```python
enhanced_graph = Neo4jGraph(
    url="bolt://localhost:7687",
    username="neo4j",
    password="password",
    enhanced_schema=True,
)
print(enhanced_graph.schema)
```

```output
Node properties:
- **Movie**
  - `runtime: INTEGER` Min: 120, Max: 120
  - `name: STRING` Available options: ['Top Gun']
- **Actor**
  - `name: STRING` Available options: ['Tom Cruise', 'Val Kilmer', 'Anthony Edwards', 'Meg Ryan']
Relationship properties:

The relationships:
(:Actor)-[:ACTED_IN]->(:Movie)
```

## ‡§ó‡•ç‡§∞‡§æ‡§´‡§º ‡§ï‡§æ ‡§ï‡•ç‡§µ‡•á‡§∞‡•Ä ‡§ï‡§∞‡§®‡§æ

‡§Ö‡§¨ ‡§π‡§Æ ‡§ó‡•ç‡§∞‡§æ‡§´‡§º ‡§∏‡§æ‡§á‡§´‡§∞ ‡§ï‡•ç‡§Ø‡•Ç‡§è ‡§∂‡•ç‡§∞‡•É‡§Ç‡§ñ‡§≤‡§æ ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡§ï‡•á ‡§ó‡•ç‡§∞‡§æ‡§´‡§º ‡§∏‡•á ‡§™‡•ç‡§∞‡§∂‡•ç‡§® ‡§™‡•Ç‡§õ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç‡•§

```python
chain = GraphCypherQAChain.from_llm(
    ChatOpenAI(temperature=0), graph=graph, verbose=True
)
```

```python
chain.invoke({"query": "Who played in Top Gun?"})
```

```output


[1m> Entering new GraphCypherQAChain chain...[0m
Generated Cypher:
[32;1m[1;3mMATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WHERE m.name = 'Top Gun'
RETURN a.name[0m
Full Context:
[32;1m[1;3m[{'a.name': 'Anthony Edwards'}, {'a.name': 'Meg Ryan'}, {'a.name': 'Val Kilmer'}, {'a.name': 'Tom Cruise'}][0m

[1m> Finished chain.[0m
```

```output
{'query': 'Who played in Top Gun?',
 'result': 'Anthony Edwards, Meg Ryan, Val Kilmer, Tom Cruise played in Top Gun.'}
```

## ‡§™‡§∞‡§ø‡§£‡§æ‡§Æ‡•ã‡§Ç ‡§ï‡•Ä ‡§∏‡§Ç‡§ñ‡•ç‡§Ø‡§æ ‡§∏‡•Ä‡§Æ‡§ø‡§§ ‡§ï‡§∞‡•á‡§Ç

‡§Ü‡§™ `top_k` ‡§™‡•à‡§∞‡§æ‡§Æ‡•Ä‡§ü‡§∞ ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡§ï‡•á ‡§∏‡§æ‡§á‡§´‡§∞ ‡§ï‡•ç‡§Ø‡•Ç‡§è ‡§∂‡•ç‡§∞‡•É‡§Ç‡§ñ‡§≤‡§æ ‡§∏‡•á ‡§™‡§∞‡§ø‡§£‡§æ‡§Æ‡•ã‡§Ç ‡§ï‡•Ä ‡§∏‡§Ç‡§ñ‡•ç‡§Ø‡§æ ‡§∏‡•Ä‡§Æ‡§ø‡§§ ‡§ï‡§∞ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç‡•§
‡§°‡§ø‡§´‡§º‡•â‡§≤‡•ç‡§ü 10 ‡§π‡•à‡•§

```python
chain = GraphCypherQAChain.from_llm(
    ChatOpenAI(temperature=0), graph=graph, verbose=True, top_k=2
)
```

```python
chain.invoke({"query": "Who played in Top Gun?"})
```

```output


[1m> Entering new GraphCypherQAChain chain...[0m
Generated Cypher:
[32;1m[1;3mMATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WHERE m.name = 'Top Gun'
RETURN a.name[0m
Full Context:
[32;1m[1;3m[{'a.name': 'Anthony Edwards'}, {'a.name': 'Meg Ryan'}][0m

[1m> Finished chain.[0m
```

```output
{'query': 'Who played in Top Gun?',
 'result': 'Anthony Edwards, Meg Ryan played in Top Gun.'}
```

## ‡§Æ‡§ß‡•ç‡§Ø‡§µ‡§∞‡•ç‡§§‡•Ä ‡§™‡§∞‡§ø‡§£‡§æ‡§Æ ‡§≤‡•å‡§ü‡§æ‡§è‡§Ç

‡§Ü‡§™ `return_intermediate_steps` ‡§™‡•à‡§∞‡§æ‡§Æ‡•Ä‡§ü‡§∞ ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡§ï‡•á ‡§∏‡§æ‡§á‡§´‡§∞ ‡§ï‡•ç‡§Ø‡•Ç‡§è ‡§∂‡•ç‡§∞‡•É‡§Ç‡§ñ‡§≤‡§æ ‡§∏‡•á ‡§Æ‡§ß‡•ç‡§Ø‡§µ‡§∞‡•ç‡§§‡•Ä ‡§ö‡§∞‡§£ ‡§≤‡•å‡§ü‡§æ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç‡•§

```python
chain = GraphCypherQAChain.from_llm(
    ChatOpenAI(temperature=0), graph=graph, verbose=True, return_intermediate_steps=True
)
```

```python
result = chain.invoke({"query": "Who played in Top Gun?"})
print(f"Intermediate steps: {result['intermediate_steps']}")
print(f"Final answer: {result['result']}")
```

```output


[1m> Entering new GraphCypherQAChain chain...[0m
Generated Cypher:
[32;1m[1;3mMATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WHERE m.name = 'Top Gun'
RETURN a.name[0m
Full Context:
[32;1m[1;3m[{'a.name': 'Anthony Edwards'}, {'a.name': 'Meg Ryan'}, {'a.name': 'Val Kilmer'}, {'a.name': 'Tom Cruise'}][0m

[1m> Finished chain.[0m
Intermediate steps: [{'query': "MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)\nWHERE m.name = 'Top Gun'\nRETURN a.name"}, {'context': [{'a.name': 'Anthony Edwards'}, {'a.name': 'Meg Ryan'}, {'a.name': 'Val Kilmer'}, {'a.name': 'Tom Cruise'}]}]
Final answer: Anthony Edwards, Meg Ryan, Val Kilmer, Tom Cruise played in Top Gun.
```

## ‡§™‡•ç‡§∞‡§§‡•ç‡§Ø‡§ï‡•ç‡§∑ ‡§™‡§∞‡§ø‡§£‡§æ‡§Æ ‡§≤‡•å‡§ü‡§æ‡§è‡§Ç

‡§Ü‡§™ `return_direct` ‡§™‡•à‡§∞‡§æ‡§Æ‡•Ä‡§ü‡§∞ ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡§ï‡•á ‡§∏‡§æ‡§á‡§´‡§∞ ‡§ï‡•ç‡§Ø‡•Ç‡§è ‡§∂‡•ç‡§∞‡•É‡§Ç‡§ñ‡§≤‡§æ ‡§∏‡•á ‡§™‡•ç‡§∞‡§§‡•ç‡§Ø‡§ï‡•ç‡§∑ ‡§™‡§∞‡§ø‡§£‡§æ‡§Æ ‡§≤‡•å‡§ü‡§æ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç‡•§

```python
chain = GraphCypherQAChain.from_llm(
    ChatOpenAI(temperature=0), graph=graph, verbose=True, return_direct=True
)
```

```python
chain.invoke({"query": "Who played in Top Gun?"})
```

```output


[1m> Entering new GraphCypherQAChain chain...[0m
Generated Cypher:
[32;1m[1;3mMATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WHERE m.name = 'Top Gun'
RETURN a.name[0m

[1m> Finished chain.[0m
```

```output
{'query': 'Who played in Top Gun?',
 'result': [{'a.name': 'Anthony Edwards'},
  {'a.name': 'Meg Ryan'},
  {'a.name': 'Val Kilmer'},
  {'a.name': 'Tom Cruise'}]}
```

## ‡§∏‡§æ‡§á‡§´‡§∞ ‡§ú‡§®‡§∞‡•á‡§∂‡§® ‡§™‡•ç‡§∞‡•â‡§Æ‡•ç‡§™‡•ç‡§ü ‡§Æ‡•á‡§Ç ‡§â‡§¶‡§æ‡§π‡§∞‡§£ ‡§ú‡•ã‡§°‡§º‡•á‡§Ç

‡§Ü‡§™ ‡§µ‡§ø‡§∂‡§ø‡§∑‡•ç‡§ü ‡§™‡•ç‡§∞‡§∂‡•ç‡§®‡•ã‡§Ç ‡§ï‡•á ‡§≤‡§ø‡§è ‡§ú‡§®‡§∞‡•á‡§ü ‡§ï‡§ø‡§è ‡§ú‡§æ‡§®‡•á ‡§µ‡§æ‡§≤‡•á ‡§∏‡§æ‡§á‡§´‡§∞ ‡§¨‡§Ø‡§æ‡§® ‡§ï‡•ã ‡§™‡§∞‡§ø‡§≠‡§æ‡§∑‡§ø‡§§ ‡§ï‡§∞ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç‡•§

```python
from langchain_core.prompts.prompt import PromptTemplate

CYPHER_GENERATION_TEMPLATE = """Task:Generate Cypher statement to query a graph database.
Instructions:
Use only the provided relationship types and properties in the schema.
Do not use any other relationship types or properties that are not provided.
Schema:
{schema}
Note: Do not include any explanations or apologies in your responses.
Do not respond to any questions that might ask anything else than for you to construct a Cypher statement.
Do not include any text except the generated Cypher statement.
Examples: Here are a few examples of generated Cypher statements for particular questions:
# How many people played in Top Gun?
MATCH (m:Movie {{title:"Top Gun"}})<-[:ACTED_IN]-()
RETURN count(*) AS numberOfActors

The question is:
{question}"""

CYPHER_GENERATION_PROMPT = PromptTemplate(
    input_variables=["schema", "question"], template=CYPHER_GENERATION_TEMPLATE
)

chain = GraphCypherQAChain.from_llm(
    ChatOpenAI(temperature=0),
    graph=graph,
    verbose=True,
    cypher_prompt=CYPHER_GENERATION_PROMPT,
)
```

```python
chain.invoke({"query": "How many people played in Top Gun?"})
```

```output


[1m> Entering new GraphCypherQAChain chain...[0m
Generated Cypher:
[32;1m[1;3mMATCH (:Movie {name:"Top Gun"})<-[:ACTED_IN]-()
RETURN count(*) AS numberOfActors[0m
Full Context:
[32;1m[1;3m[{'numberOfActors': 4}][0m

[1m> Finished chain.[0m
```

```output
{'query': 'How many people played in Top Gun?',
 'result': 'There were 4 actors who played in Top Gun.'}
```

## ‡§∏‡§æ‡§á‡§´‡§∞ ‡§î‡§∞ ‡§â‡§§‡•ç‡§§‡§∞ ‡§ú‡§®‡§∞‡•á‡§∂‡§® ‡§ï‡•á ‡§≤‡§ø‡§è ‡§Ö‡§≤‡§ó ‡§è‡§≤‡§è‡§≤‡§è‡§Æ ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡•á‡§Ç

‡§Ü‡§™ `cypher_llm` ‡§î‡§∞ `qa_llm` ‡§™‡•à‡§∞‡§æ‡§Æ‡•Ä‡§ü‡§∞ ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡§ï‡•á ‡§Ö‡§≤‡§ó-‡§Ö‡§≤‡§ó ‡§è‡§≤‡§è‡§≤‡§è‡§Æ ‡§ï‡•ã ‡§™‡§∞‡§ø‡§≠‡§æ‡§∑‡§ø‡§§ ‡§ï‡§∞ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç‡•§

```python
chain = GraphCypherQAChain.from_llm(
    graph=graph,
    cypher_llm=ChatOpenAI(temperature=0, model="gpt-3.5-turbo"),
    qa_llm=ChatOpenAI(temperature=0, model="gpt-3.5-turbo-16k"),
    verbose=True,
)
```

```python
chain.invoke({"query": "Who played in Top Gun?"})
```

```output


[1m> Entering new GraphCypherQAChain chain...[0m
Generated Cypher:
[32;1m[1;3mMATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WHERE m.name = 'Top Gun'
RETURN a.name[0m
Full Context:
[32;1m[1;3m[{'a.name': 'Anthony Edwards'}, {'a.name': 'Meg Ryan'}, {'a.name': 'Val Kilmer'}, {'a.name': 'Tom Cruise'}][0m

[1m> Finished chain.[0m
```

```output
{'query': 'Who played in Top Gun?',
 'result': 'Anthony Edwards, Meg Ryan, Val Kilmer, and Tom Cruise played in Top Gun.'}
```

## ‡§®‡§ø‡§∞‡•ç‡§¶‡§ø‡§∑‡•ç‡§ü ‡§®‡•ã‡§° ‡§î‡§∞ ‡§∏‡§Ç‡§¨‡§Ç‡§ß ‡§™‡•ç‡§∞‡§ï‡§æ‡§∞‡•ã‡§Ç ‡§ï‡•ã ‡§Ö‡§®‡§¶‡•á‡§ñ‡§æ ‡§ï‡§∞‡•á‡§Ç

‡§Ü‡§™ ‡§∏‡§æ‡§á‡§´‡§∞ ‡§¨‡§Ø‡§æ‡§® ‡§ú‡§®‡§∞‡•á‡§ü ‡§ï‡§∞‡§§‡•á ‡§∏‡§Æ‡§Ø ‡§ó‡•ç‡§∞‡§æ‡§´‡§º ‡§∏‡•ç‡§ï‡•Ä‡§Æ‡§æ ‡§ï‡•á ‡§ï‡•Å‡§õ ‡§π‡§ø‡§∏‡•ç‡§∏‡•ã‡§Ç ‡§ï‡•ã ‡§Ö‡§®‡§¶‡•á‡§ñ‡§æ ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è `include_types` ‡§Ø‡§æ `exclude_types` ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç‡•§

```python
chain = GraphCypherQAChain.from_llm(
    graph=graph,
    cypher_llm=ChatOpenAI(temperature=0, model="gpt-3.5-turbo"),
    qa_llm=ChatOpenAI(temperature=0, model="gpt-3.5-turbo-16k"),
    verbose=True,
    exclude_types=["Movie"],
)
```

```python
# Inspect graph schema
print(chain.graph_schema)
```

```output
Node properties are the following:
Actor {name: STRING}
Relationship properties are the following:

The relationships are the following:
```

## ‡§ú‡§®‡§∞‡•á‡§ü ‡§ï‡§ø‡§è ‡§ó‡§è ‡§∏‡§æ‡§á‡§´‡§∞ ‡§¨‡§Ø‡§æ‡§®‡•ã‡§Ç ‡§ï‡•Ä ‡§™‡•Å‡§∑‡•ç‡§ü‡§ø ‡§ï‡§∞‡•á‡§Ç

‡§Ü‡§™ `validate_cypher` ‡§™‡•à‡§∞‡§æ‡§Æ‡•Ä‡§ü‡§∞ ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡§ï‡•á ‡§ú‡§®‡§∞‡•á‡§ü ‡§ï‡§ø‡§è ‡§ó‡§è ‡§∏‡§æ‡§á‡§´‡§∞ ‡§¨‡§Ø‡§æ‡§®‡•ã‡§Ç ‡§ï‡•Ä ‡§™‡•Å‡§∑‡•ç‡§ü‡§ø ‡§î‡§∞ ‡§∏‡•Å‡§ß‡§æ‡§∞ ‡§ï‡§∞ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç‡•§

```python
chain = GraphCypherQAChain.from_llm(
    llm=ChatOpenAI(temperature=0, model="gpt-3.5-turbo"),
    graph=graph,
    verbose=True,
    validate_cypher=True,
)
```

```python
chain.invoke({"query": "Who played in Top Gun?"})
```

```output


[1m> Entering new GraphCypherQAChain chain...[0m
Generated Cypher:
[32;1m[1;3mMATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WHERE m.name = 'Top Gun'
RETURN a.name[0m
Full Context:
[32;1m[1;3m[{'a.name': 'Anthony Edwards'}, {'a.name': 'Meg Ryan'}, {'a.name': 'Val Kilmer'}, {'a.name': 'Tom Cruise'}][0m

[1m> Finished chain.[0m
```

```output
{'query': 'Who played in Top Gun?',
 'result': 'Anthony Edwards, Meg Ryan, Val Kilmer, Tom Cruise played in Top Gun.'}
```
