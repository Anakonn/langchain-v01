---
translated: true
---

# Google Bigtable

> [Google Cloud Bigtable](https://cloud.google.com/bigtable) рдПрдХ рдХреБрдВрдЬреА-рдореВрд▓реНрдп рдФрд░ рд╡реНрдпрд╛рдкрдХ-рд╕реНрддрдВрдн рд╕реНрдЯреЛрд░ рд╣реИ, рдЬреЛ рд╕рдВрд░рдЪрд┐рдд, рдЕрд░реНрдз-рд╕рдВрд░рдЪрд┐рдд рдпрд╛ рдЕрд╡реНрдпрд╡рд╕реНрдерд┐рдд рдбреЗрдЯрд╛ рддрдХ рддреЗрдЬрд╝ рдкрд╣реБрдВрдЪ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреБрдХреНрдд рд╣реИред Bigtable рдХреЗ Langchain рдПрдХреАрдХрд░рдг рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЕрдкрдиреЗ рдбреЗрдЯрд╛рдмреЗрд╕ рдЕрдиреБрдкреНрд░рдпреЛрдЧ рдХреЛ AI-рд╕рдВрдЪрд╛рд▓рд┐рдд рдЕрдиреБрднрд╡реЛрдВ рдХреЛ рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП рд╡рд┐рд╕реНрддрд╛рд░рд┐рдд рдХрд░реЗрдВред

рдпрд╣ рдиреЛрдЯрдмреБрдХ [Google Cloud Bigtable](https://cloud.google.com/bigtable) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЪреИрдЯ рд╕рдВрджреЗрд╢ рдЗрддрд┐рд╣рд╛рд╕ рдХреЛ `BigtableChatMessageHistory` рдХреНрд▓рд╛рд╕ рдХреЗ рд╕рд╛рде рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд░рдиреЗ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдмрддрд╛рддрд╛ рд╣реИред

рдкреИрдХреЗрдЬ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА [GitHub](https://github.com/googleapis/langchain-google-bigtable-python/) рдкрд░ред

[![Open In Colab](https://colab.research.google.com/assets/colab-badge.svg)](https://colab.research.google.com/github/googleapis/langchain-google-bigtable-python/blob/main/docs/chat_message_history.ipynb)

## рд╢реБрд░реВ рдХрд░рдиреЗ рд╕реЗ рдкрд╣рд▓реЗ

рдЗрд╕ рдиреЛрдЯрдмреБрдХ рдХреЛ рдЪрд▓рд╛рдиреЗ рдХреЗ рд▓рд┐рдП, рдЖрдкрдХреЛ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХрд╛рд░реНрдп рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрдЧреА:

* [рдПрдХ Google Cloud рдкреНрд░реЛрдЬреЗрдХреНрдЯ рдмрдирд╛рдПрдВ](https://developers.google.com/workspace/guides/create-project)
* [Bigtable API рдХреЛ рд╕рдХреНрд╖рдо рдХрд░реЗрдВ](https://console.cloud.google.com/flows/enableapi?apiid=bigtable.googleapis.com)
* [рдПрдХ Bigtable рдЗрдВрд╕реНрдЯреЗрдВрд╕ рдмрдирд╛рдПрдВ](https://cloud.google.com/bigtable/docs/creating-instance)
* [рдПрдХ Bigtable рдЯреЗрдмрд▓ рдмрдирд╛рдПрдВ](https://cloud.google.com/bigtable/docs/managing-tables)
* [Bigtable рдПрдХреНрд╕реЗрд╕ рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓ рдмрдирд╛рдПрдВ](https://developers.google.com/workspace/guides/create-credentials)

### ЁЯжЬЁЯФЧ рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдЗрдВрд╕реНрдЯреЙрд▓реЗрд╢рди

рдПрдХреАрдХрд░рдг `langchain-google-bigtable` рдкреИрдХреЗрдЬ рдореЗрдВ рдЕрдкрдиреЗ рдЦреБрдж рдХрд╛ рд╣реИ, рдЗрд╕рд▓рд┐рдП рд╣рдореЗрдВ рдЗрд╕реЗ рдЗрдВрд╕реНрдЯреЙрд▓ рдХрд░рдирд╛ рд╣реЛрдЧрд╛ред

```python
%pip install -upgrade --quiet langchain-google-bigtable
```

**рдХреЗрд╡рд▓ Colab**: рдХрд░реНрдирд▓ рдХреЛ рдкреБрдирдГ рдкреНрд░рд╛рд░рдВрдн рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХреЛрд╢рд┐рдХрд╛ рдХреЛ рдЕрдирдХрдореЗрдВрдЯ рдХрд░реЗрдВ рдпрд╛ рдХрд░реНрдирд▓ рдХреЛ рдкреБрдирдГ рдкреНрд░рд╛рд░рдВрдн рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдмрдЯрди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВред Vertex AI Workbench рдХреЗ рд▓рд┐рдП, рд╢реАрд░реНрд╖ рдкрд░ рджрд┐рдП рдЧрдП рдмрдЯрди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЯрд░реНрдорд┐рдирд▓ рдХреЛ рдкреБрдирдГ рдкреНрд░рд╛рд░рдВрдн рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

```python
# # Automatically restart kernel after installs so that your environment can access the new packages
# import IPython

# app = IPython.Application.instance()
# app.kernel.do_shutdown(True)
```

### тШБ рдЕрдкрдиреЗ Google Cloud рдкреНрд░реЛрдЬреЗрдХреНрдЯ рдХреЛ рд╕реЗрдЯ рдХрд░реЗрдВ

рдЗрд╕ рдиреЛрдЯрдмреБрдХ рдореЗрдВ Google Cloud рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЕрдкрдиреЗ Google Cloud рдкреНрд░реЛрдЬреЗрдХреНрдЯ рдХреЛ рд╕реЗрдЯ рдХрд░реЗрдВред

рдпрджрд┐ рдЖрдк рдЕрдкрдиреЗ рдкреНрд░реЛрдЬреЗрдХреНрдЯ рдЖрдИрдбреА рдХреЛ рдирд╣реАрдВ рдЬрд╛рдирддреЗ рд╣реИрдВ, рддреЛ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░реЗрдВ:

* `gcloud config list` рдЪрд▓рд╛рдПрдВред
* `gcloud projects list` рдЪрд▓рд╛рдПрдВред
* рд╕рдорд░реНрдерди рдкреГрд╖реНрда рджреЗрдЦреЗрдВ: [рдкреНрд░реЛрдЬреЗрдХреНрдЯ рдЖрдИрдбреА рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдПрдВ](https://support.google.com/googleapi/answer/7014113)ред

```python
# @markdown Please fill in the value below with your Google Cloud project ID and then run the cell.

PROJECT_ID = "my-project-id"  # @param {type:"string"}

# Set the project id
!gcloud config set project {PROJECT_ID}
```

### ЁЯФР рдкреНрд░рдорд╛рдгреАрдХрд░рдг

рдЕрдкрдиреЗ Google Cloud рдкреНрд░реЛрдЬреЗрдХреНрдЯ рддрдХ рдкрд╣реБрдВрдЪрдиреЗ рдХреЗ рд▓рд┐рдП рдЗрд╕ рдиреЛрдЯрдмреБрдХ рдореЗрдВ рд▓реЙрдЧ рдЗрди рдХрд┐рдП рдЧрдП IAM рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рд░реВрдк рдореЗрдВ Google Cloud рдореЗрдВ рдкреНрд░рдорд╛рдгрд┐рдд рдХрд░реЗрдВред

- рдпрджрд┐ рдЖрдк рдЗрд╕ рдиреЛрдЯрдмреБрдХ рдХреЛ рдЪрд▓рд╛рдиреЗ рдХреЗ рд▓рд┐рдП Colab рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд░рд╣реЗ рд╣реИрдВ, рддреЛ рдиреАрдЪреЗ рджрд┐рдП рдЧрдП рдХреЛрд╢рд┐рдХрд╛ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ рдФрд░ рдЖрдЧреЗ рдмрдврд╝реЗрдВред
- рдпрджрд┐ рдЖрдк Vertex AI Workbench рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд░рд╣реЗ рд╣реИрдВ, рддреЛ [рдпрд╣рд╛рдВ](https://github.com/GoogleCloudPlatform/generative-ai/tree/main/setup-env) рджрд┐рдП рдЧрдП рд╕реЗрдЯрдЕрдк рдирд┐рд░реНрджреЗрд╢реЛрдВ рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВред

```python
from google.colab import auth

auth.authenticate_user()
```

## рдореВрд▓рднреВрдд рдЙрдкрдпреЛрдЧ

### Bigtable рд╕реНрдХреАрдорд╛ рдХреЛ рдЗрдирд┐рд╢рд┐рдпрд▓рд╛рдЗрдЬрд╝ рдХрд░реЗрдВ

BigtableChatMessageHistory рдХреЗ рд▓рд┐рдП рд╕реНрдХреАрдорд╛ рдореЗрдВ рдЗрдВрд╕реНрдЯреЗрдВрд╕ рдФрд░ рдЯреЗрдмрд▓ рдореМрдЬреВрдж рд╣реЛрдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ, рдФрд░ `langchain` рдирд╛рдордХ рдПрдХ рдХреЙрд▓рдо рдкрд░рд┐рд╡рд╛рд░ рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдПред

```python
# @markdown Please specify an instance and a table for demo purpose.
INSTANCE_ID = "my_instance"  # @param {type:"string"}
TABLE_ID = "my_table"  # @param {type:"string"}
```

рдпрджрд┐ рдЯреЗрдмрд▓ рдпрд╛ рдХреЙрд▓рдо рдкрд░рд┐рд╡рд╛рд░ рдореМрдЬреВрдж рдирд╣реАрдВ рд╣реИрдВ, рддреЛ рдЖрдк рдЙрдиреНрд╣реЗрдВ рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдлрд╝рдВрдХреНрд╢рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:

```python
from google.cloud import bigtable
from langchain_google_bigtable import create_chat_history_table

create_chat_history_table(
    instance_id=INSTANCE_ID,
    table_id=TABLE_ID,
)
```

### BigtableChatMessageHistory

`BigtableChatMessageHistory` рдХреНрд▓рд╛рд╕ рдХреЛ рдЗрдирд┐рд╢рд┐рдпрд▓рд╛рдЗрдЬрд╝ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдкрдХреЛ рдХреЗрд╡рд▓ 3 рдЪреАрдЬрд╝реЗрдВ рдкреНрд░рджрд╛рди рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ:

1. `instance_id` - рдЪреИрдЯ рд╕рдВрджреЗрд╢ рдЗрддрд┐рд╣рд╛рд╕ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рдиреЗ рд╡рд╛рд▓рд╛ Bigtable рдЗрдВрд╕реНрдЯреЗрдВрд╕ред
1. `table_id`: рдЪреИрдЯ рд╕рдВрджреЗрд╢ рдЗрддрд┐рд╣рд╛рд╕ рдХреЛ рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП Bigtable рдЯреЗрдмрд▓ред
1. `session_id` - рдПрдХ рдЕрджреНрд╡рд┐рддреАрдп рдкрд╣рдЪрд╛рдирдХрд░реНрддрд╛ рд╕реНрдЯреНрд░рд┐рдВрдЧ рдЬреЛ рд╕рддреНрд░ рдХреЗ рд▓рд┐рдП рдПрдХ рдЖрдИрдбреА рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░рддрд╛ рд╣реИред

```python
from langchain_google_bigtable import BigtableChatMessageHistory

message_history = BigtableChatMessageHistory(
    instance_id=INSTANCE_ID,
    table_id=TABLE_ID,
    session_id="user-session-id",
)

message_history.add_user_message("hi!")
message_history.add_ai_message("whats up?")
```

```python
message_history.messages
```

#### рд╕рдлрд╛рдИ рдХрд░рдирд╛

рдЬрдм рдХрд┐рд╕реА рд╡рд┐рд╢рд┐рд╖реНрдЯ рд╕рддреНрд░ рдХрд╛ рдЗрддрд┐рд╣рд╛рд╕ рдкреБрд░рд╛рдирд╛ рд╣реЛ рдЬрд╛рддрд╛ рд╣реИ рдФрд░ рд╣рдЯрд╛рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рддреЛ рдЗрд╕реЗ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рддрд░реАрдХреЗ рд╕реЗ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

**рдиреЛрдЯ:** рдПрдХ рдмрд╛рд░ рд╣рдЯрд╛ рджрд┐рдП рдЬрд╛рдиреЗ рдкрд░, рдбреЗрдЯрд╛ Bigtable рдореЗрдВ рдирд╣реАрдВ рд░рдЦрд╛ рдЬрд╛рддрд╛ рд╣реИ рдФрд░ рдпрд╣ рд╕рджрд╛ рдХреЗ рд▓рд┐рдП рдЪрд▓рд╛ рдЬрд╛рддрд╛ рд╣реИред

```python
message_history.clear()
```

## рдЙрдиреНрдирдд рдЙрдкрдпреЛрдЧ

### рдХрд╕реНрдЯрдо рдХреНрд▓рд╛рдЗрдВрдЯ

рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ рдмрдирд╛рдпрд╛ рдЧрдпрд╛ рдХреНрд▓рд╛рдЗрдВрдЯ рдХреЗрд╡рд▓ admin=True рд╡рд┐рдХрд▓реНрдк рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИред рдЧреИрд░-рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, [рдХрд╕реНрдЯрдо рдХреНрд▓рд╛рдЗрдВрдЯ](https://cloud.google.com/python/docs/reference/bigtable/latest/client#class-googlecloudbigtableclientclientprojectnone-credentialsnone-readonlyfalse-adminfalse-clientinfonone-clientoptionsnone-adminclientoptionsnone-channelnone) рдХреЛ рдирд┐рд░реНрдорд╛рддрд╛ рдореЗрдВ рдкрд╛рд╕ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

```python
from google.cloud import bigtable

client = (bigtable.Client(...),)

create_chat_history_table(
    instance_id="my-instance",
    table_id="my-table",
    client=client,
)

custom_client_message_history = BigtableChatMessageHistory(
    instance_id="my-instance",
    table_id="my-table",
    client=client,
)
```
