---
translated: true
---

# рдорд╛рдЗрдХреНрд░реЛрд╕реЙрдлреНрдЯ OneDrive

>[рдорд╛рдЗрдХреНрд░реЛрд╕реЙрдлреНрдЯ OneDrive](https://en.wikipedia.org/wiki/OneDrive) (рдкрд╣рд▓реЗ `SkyDrive`) рдорд╛рдЗрдХреНрд░реЛрд╕реЙрдлреНрдЯ рджреНрд╡рд╛рд░рд╛ рд╕рдВрдЪрд╛рд▓рд┐рдд рдПрдХ рдлрд╝рд╛рдЗрд▓ рд╣реЛрд╕реНрдЯрд┐рдВрдЧ рд╕реЗрд╡рд╛ рд╣реИред

рдпрд╣ рдиреЛрдЯрдмреБрдХ `OneDrive` рд╕реЗ рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рд▓реЛрдб рдХрд░рдиреЗ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдХрд╡рд░ рдХрд░рддрд╛ рд╣реИред рд╡рд░реНрддрдорд╛рди рдореЗрдВ, рдХреЗрд╡рд▓ docx, doc рдФрд░ pdf рдлрд╝рд╛рдЗрд▓реЛрдВ рдХрд╛ рд╕рдорд░реНрдерди рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред

## рдкреВрд░реНрд╡рд╛рдкреЗрдХреНрд╖рд╛рдПрдВ

1. [рдорд╛рдЗрдХреНрд░реЛрд╕реЙрдлреНрдЯ рдЖрдЗрдбреЗрдВрдЯрд┐рдЯреА рдкреНрд▓реЗрдЯрдлреЙрд░реНрдо](https://learn.microsoft.com/en-us/azure/active-directory/develop/quickstart-register-app) рдХреЗ рдирд┐рд░реНрджреЗрд╢реЛрдВ рдХрд╛ рдкрд╛рд▓рди рдХрд░рддреЗ рд╣реБрдП рдПрдХ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдкрдВрдЬреАрдХреГрдд рдХрд░реЗрдВред
2. рдкрдВрдЬреАрдХрд░рдг рдкреВрд░рд╛ рд╣реЛрдиреЗ рдкрд░, Azure рдкреЛрд░реНрдЯрд▓ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдкрдВрдЬреАрдХрд░рдг рдХреЗ рдЕрд╡рд▓реЛрдХрди рдкреЗрди рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд░рддрд╛ рд╣реИред рдЖрдк рдПрдкреНрд▓рд┐рдХреЗрд╢рди (рдХреНрд▓рд╛рдЗрдВрдЯ) ID рджреЗрдЦрддреЗ рд╣реИрдВред рдЗрд╕реЗ `рдХреНрд▓рд╛рдЗрдВрдЯ ID` рднреА рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИ, рдпрд╣ рдореВрд▓реНрдп рдорд╛рдЗрдХреНрд░реЛрд╕реЙрдлреНрдЯ рдЖрдЗрдбреЗрдВрдЯрд┐рдЯреА рдкреНрд▓реЗрдЯрдлреЙрд░реНрдо рдореЗрдВ рдЖрдкрдХреЗ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЛ рдЕрджреНрд╡рд┐рддреАрдп рд░реВрдк рд╕реЗ рдкрд╣рдЪрд╛рдирддрд╛ рд╣реИред
3. **рдЖрдЗрдЯрдо 1** рдореЗрдВ рдЖрдк рдЬреЛ рдХрджрдо рдЕрдиреБрд╕рд░рдг рдХрд░ рд░рд╣реЗ рд╣реИрдВ, рдЙрдирдореЗрдВ рдЖрдк рд░реАрдбрд╛рдпрд░реЗрдХреНрдЯ URI рдХреЛ `http://localhost:8000/callback` рдХреЗ рд░реВрдк рдореЗрдВ рд╕реЗрдЯ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред
4. **рдЖрдЗрдЯрдо 1** рдореЗрдВ рдЖрдк рдЬреЛ рдХрджрдо рдЕрдиреБрд╕рд░рдг рдХрд░ рд░рд╣реЗ рд╣реИрдВ, рдЙрдирдореЗрдВ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рд╕реАрдХреНрд░реЗрдЯреНрд╕ рдЕрдиреБрднрд╛рдЧ рдХреЗ рддрд╣рдд рдПрдХ рдирдпрд╛ рдкрд╛рд╕рд╡рд░реНрдб (`client_secret`) рдЬрдирд░реЗрдЯ рдХрд░реЗрдВред
5. рдЗрд╕ [рджрд╕реНрддрд╛рд╡реЗрдЬрд╝](https://learn.microsoft.com/en-us/azure/active-directory/develop/quickstart-configure-app-expose-web-apis#add-a-scope) рдХреЗ рдирд┐рд░реНрджреЗрд╢реЛрдВ рдХрд╛ рдкрд╛рд▓рди рдХрд░реЗрдВ рддрд╛рдХрд┐ рдЖрдк рдЕрдкрдиреЗ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдореЗрдВ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд `SCOPES` (`offline_access` рдФрд░ `Files.Read.All`) рдЬреЛрдбрд╝ рд╕рдХреЗрдВред
6. [Graph Explorer Playground](https://developer.microsoft.com/en-us/graph/graph-explorer) рдкрд░ рдЬрд╛рдПрдВ рддрд╛рдХрд┐ рдЖрдк рдЕрдкрдирд╛ `OneDrive ID` рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХреЗрдВред рдкрд╣рд▓рд╛ рдХрджрдо рдпрд╣ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рдирд╛ рд╣реИ рдХрд┐ рдЖрдк рдЕрдкрдиреЗ OneDrive рдЦрд╛рддреЗ рд╕реЗ рдЬреБрдбрд╝реЗ рдЦрд╛рддреЗ рдореЗрдВ рд▓реЙрдЧ рдЗрди рд╣реИрдВред рдлрд┐рд░ рдЖрдкрдХреЛ `https://graph.microsoft.com/v1.0/me/drive` рдкрд░ рдПрдХ рдЕрдиреБрд░реЛрдз рдХрд░рдирд╛ рд╣реЛрдЧрд╛ рдФрд░ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдореЗрдВ рдПрдХ рдлрд╝реАрд▓реНрдб `id` рд╣реЛрдЧрд╛ рдЬреЛ рдЖрдкрдХреЗ OneDrive рдЦрд╛рддреЗ рдХреА ID рдХреЛ рдзрд╛рд░рдг рдХрд░рддрд╛ рд╣реИред
7. рдЖрдкрдХреЛ `pip install o365` рдХрдорд╛рдВрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ o365 рдкреИрдХреЗрдЬ рдЗрдВрд╕реНрдЯреЙрд▓ рдХрд░рдирд╛ рд╣реЛрдЧрд╛ред
8. рдЪрд░рдгреЛрдВ рдХреЛ рдкреВрд░рд╛ рдХрд░рдиреЗ рдХреЗ рдмрд╛рдж рдЖрдкрдХреЗ рдкрд╛рд╕ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдореВрд▓реНрдп рд╣реЛрдиреЗ рдЪрд╛рд╣рд┐рдП:
- `CLIENT_ID`
- `CLIENT_SECRET`
- `DRIVE_ID`

## ЁЯзС OneDrive рд╕реЗ рдЖрдкрдХреЗ рджрд╕реНрддрд╛рд╡реЗрдЬреЛрдВ рдХреЛ рдЗрдВрдЬреЗрд╕реНрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдирд┐рд░реНрджреЗрд╢

### ЁЯФС рдкреНрд░рдорд╛рдгреАрдХрд░рдг

рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ, `OneDriveLoader` рдпрд╣ рдорд╛рдирддрд╛ рд╣реИ рдХрд┐ `CLIENT_ID` рдФрд░ `CLIENT_SECRET` рдХреЗ рдореВрд▓реНрдп рдХреНрд░рдорд╢рдГ `O365_CLIENT_ID` рдФрд░ `O365_CLIENT_SECRET` рдирд╛рдордХ рдкрд░реНрдпрд╛рд╡рд░рдг рдЪрд░ рдХреЗ рд░реВрдк рдореЗрдВ рд╕рдВрдЧреНрд░рд╣реАрдд рд╣реЛрдиреЗ рдЪрд╛рд╣рд┐рдПред рдЖрдк рдЗрди рдкрд░реНрдпрд╛рд╡рд░рдг рдЪрд░реЛрдВ рдХреЛ рдЕрдкрдиреЗ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреА рдЬрдбрд╝ рдореЗрдВ рдПрдХ `.env` рдлрд╝рд╛рдЗрд▓ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдпрд╛ рдЕрдкрдиреЗ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдореЗрдВ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХрдорд╛рдВрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдкрд╛рд╕ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

```python
os.environ['O365_CLIENT_ID'] = "YOUR CLIENT ID"
os.environ['O365_CLIENT_SECRET'] = "YOUR CLIENT SECRET"
```

рдпрд╣ рд▓реЛрдбрд░ [*рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреА рдУрд░ рд╕реЗ*](https://learn.microsoft.com/en-us/graph/auth-v2-user?context=graph%2Fapi%2F1.0&view=graph-rest-1.0) рдирд╛рдордХ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИред рдпрд╣ 2 рдЪрд░рдг рдХрд╛ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рд╣реИ рдЬрд┐рд╕рдореЗрдВ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рд╕рд╣рдорддрд┐ рджреЗрддрд╛ рд╣реИред рдЬрдм рдЖрдк рд▓реЛрдбрд░ рдХреЛ рдЗрдВрд╕реНрдЯреИрдВрд╢рд┐рдПрдЯ рдХрд░рддреЗ рд╣реИрдВ, рддреЛ рдпрд╣ рдПрдХ URL рдкреНрд░рд┐рдВрдЯ рдХрд░реЗрдЧрд╛ рдЬрд┐рд╕реЗ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рд╡рд┐рдЬрд╝рд┐рдЯ рдХрд░рдирд╛ рд╣реЛрдЧрд╛ рддрд╛рдХрд┐ рд╡рд╣ рдЖрд╡рд╢реНрдпрдХ рдЕрдиреБрдорддрд┐рдпреЛрдВ рдХреЗ рд▓рд┐рдП рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЛ рд╕рд╣рдорддрд┐ рджреЗ рд╕рдХреЗред рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рдлрд┐рд░ рдЗрд╕ URL рдкрд░ рдЬрд╛рдирд╛ рд╣реЛрдЧрд╛ рдФрд░ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЛ рд╕рд╣рдорддрд┐ рджреЗрдиреА рд╣реЛрдЧреАред рдлрд┐рд░ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рдкрд░рд┐рдгрд╛рдореА рдкреГрд╖реНрда URL рдХреЛ рдХреЙрдкреА рдХрд░рдХреЗ рдХрдВрд╕реЛрд▓ рдкрд░ рдкреЗрд╕реНрдЯ рдХрд░рдирд╛ рд╣реЛрдЧрд╛ред рдпрджрд┐ рд▓реЙрдЧрд┐рди рдкреНрд░рдпрд╛рд╕ рд╕рдлрд▓ рдерд╛, рддреЛ рдпрд╣ рд╡рд┐рдзрд┐ True рд▓реМрдЯрд╛рдПрдЧреАред

```python
from langchain_community.document_loaders.onedrive import OneDriveLoader

loader = OneDriveLoader(drive_id="YOUR DRIVE ID")
```

рдПрдХ рдмрд╛рд░ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рд╣реЛ рдЬрд╛рдиреЗ рдХреЗ рдмрд╛рдж, рд▓реЛрдбрд░ `~/.credentials/` рдлрд╝реЛрд▓реНрдбрд░ рдореЗрдВ рдПрдХ рдЯреЛрдХрди (`o365_token.txt`) рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд░реЗрдЧрд╛ред рдЗрд╕ рдЯреЛрдХрди рдХрд╛ рдЙрдкрдпреЛрдЧ рдмрд╛рдж рдореЗрдВ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдмрд┐рдирд╛ рдХреЙрдкреА/рдкреЗрд╕реНрдЯ рдЪрд░рдгреЛрдВ рдХреЗ рдЬреЛ рдкрд╣рд▓реЗ рд╕рдордЭрд╛рдП рдЧрдП рдереЗред рдЗрд╕ рдЯреЛрдХрди рдХрд╛ рдЙрдкрдпреЛрдЧ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдХреЗ рд▓рд┐рдП рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдЖрдкрдХреЛ рд▓реЛрдбрд░ рдХреЗ рдЗрдВрд╕реНрдЯреИрдВрд╢рд┐рдПрд╢рди рдореЗрдВ `auth_with_token` рдкреИрд░рд╛рдореАрдЯрд░ рдХреЛ True рдкрд░ рдмрджрд▓рдирд╛ рд╣реЛрдЧрд╛ред

```python
from langchain_community.document_loaders.onedrive import OneDriveLoader

loader = OneDriveLoader(drive_id="YOUR DRIVE ID", auth_with_token=True)
```

### ЁЯЧВя╕П рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рд▓реЛрдбрд░

#### ЁЯУС OneDrive рдбрд╛рдпрд░реЗрдХреНрдЯрд░реА рд╕реЗ рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рд▓реЛрдб рдХрд░рдирд╛

`OneDriveLoader` рдЖрдкрдХреЗ OneDrive рдХреЗ рднреАрддрд░ рдПрдХ рд╡рд┐рд╢рд┐рд╖реНрдЯ рдлрд╝реЛрд▓реНрдбрд░ рд╕реЗ рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рд▓реЛрдб рдХрд░ рд╕рдХрддрд╛ рд╣реИред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдЖрдк `Documents/clients` рдлрд╝реЛрд▓реНрдбрд░ рдореЗрдВ рд╕рдВрдЧреНрд░рд╣реАрдд рд╕рднреА рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рд▓реЛрдб рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВред

```python
from langchain_community.document_loaders.onedrive import OneDriveLoader

loader = OneDriveLoader(drive_id="YOUR DRIVE ID", folder_path="Documents/clients", auth_with_token=True)
documents = loader.load()
```

#### ЁЯУС рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рдЖрдИрдбреА рдХреА рдПрдХ рд╕реВрдЪреА рд╕реЗ рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рд▓реЛрдб рдХрд░рдирд╛

рдПрдХ рдЕрдиреНрдп рд╕рдВрднрд╛рд╡рдирд╛ рд╣реИ рдХрд┐ рдЖрдк рд▓реЛрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдкреНрд░рддреНрдпреЗрдХ рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рдХреЗ `object_id` рдХреА рдПрдХ рд╕реВрдЪреА рдкреНрд░рджрд╛рди рдХрд░реЗрдВред рдЗрд╕рдХреЗ рд▓рд┐рдП, рдЖрдкрдХреЛ [рдорд╛рдЗрдХреНрд░реЛрд╕реЙрдлреНрдЯ рдЧреНрд░рд╛рдл API](https://developer.microsoft.com/en-us/graph/graph-explorer) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╕рднреА рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ ID рдЦреЛрдЬрдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрдЧреА рдЬрд┐рд╕рдореЗрдВ рдЖрдк рд░реБрдЪрд┐ рд░рдЦрддреЗ рд╣реИрдВред рдпрд╣ [рд▓рд┐рдВрдХ](https://learn.microsoft.com/en-us/graph/api/resources/onedrive?view=graph-rest-1.0#commonly-accessed-resources) рдРрд╕реЗ рдПрдВрдбрдкреЙрдЗрдВрдЯреНрд╕ рдХреА рдПрдХ рд╕реВрдЪреА рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИ рдЬреЛ рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ ID рдХреЛ рдкреБрдирд░реНрдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдореЗрдВ рдорджрджрдЧрд╛рд░ рд╣реЛрдВрдЧреЗред

рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рдлрд╝реЛрд▓реНрдбрд░ рдХреЗ рд░реВрдЯ рдореЗрдВ рд╕рдВрдЧреНрд░рд╣реАрдд рд╕рднреА рд╡рд╕реНрддреБрдУрдВ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЬрд╛рдирдХрд╛рд░реА рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдЖрдкрдХреЛ `https://graph.microsoft.com/v1.0/drives/{YOUR DRIVE ID}/root/children` рдкрд░ рдПрдХ рдЕрдиреБрд░реЛрдз рдХрд░рдирд╛ рд╣реЛрдЧрд╛ред рдПрдХ рдмрд╛рд░ рдЖрдк рдЙрди ID рдХреА рд╕реВрдЪреА рдкреНрд░рд╛рдкреНрдд рдХрд░ рд▓реЗрддреЗ рд╣реИрдВ рдЬрд┐рдирдореЗрдВ рдЖрдк рд░реБрдЪрд┐ рд░рдЦрддреЗ рд╣реИрдВ, рддреЛ рдЖрдк рд▓реЛрдбрд░ рдХреЛ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдкреИрд░рд╛рдореАрдЯрд░реЛрдВ рдХреЗ рд╕рд╛рде рдЗрдВрд╕реНрдЯреИрдВрд╢рд┐рдПрдЯ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

```python
from langchain_community.document_loaders.onedrive import OneDriveLoader

loader = OneDriveLoader(drive_id="YOUR DRIVE ID", object_ids=["ID_1", "ID_2"], auth_with_token=True)
documents = loader.load()
```
