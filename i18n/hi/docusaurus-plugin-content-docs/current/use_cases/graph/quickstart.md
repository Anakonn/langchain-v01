---
sidebar_position: 0
translated: true
---

# рддреНрд╡рд░рд┐рдд рдкреНрд░рд╛рд░рдВрдн

рдЗрд╕ рдЧрд╛рдЗрдб рдореЗрдВ рд╣рдо рдЧреНрд░рд╛рдл рдбреЗрдЯрд╛рдмреЗрд╕ рдкрд░ рдПрдХ рдкреНрд░рд╢реНрди рдФрд░ рдЙрддреНрддрд░ рд╢реНрд░реГрдВрдЦрд▓рд╛ рдмрдирд╛рдиреЗ рдХреЗ рдореВрд▓рднреВрдд рддрд░реАрдХреЛрдВ рдкрд░ рдЪрд░реНрдЪрд╛ рдХрд░реЗрдВрдЧреЗред рдпреЗ рдкреНрд░рдгрд╛рд▓реА рд╣рдореЗрдВ рдЧреНрд░рд╛рдл рдбреЗрдЯрд╛рдмреЗрд╕ рдореЗрдВ рдбреЗрдЯрд╛ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдПрдХ рдкреНрд░рд╢реНрди рдкреВрдЫрдиреЗ рдФрд░ рдкреНрд░рд╛рдХреГрддрд┐рдХ рднрд╛рд╖рд╛ рдХрд╛ рдЙрддреНрддрд░ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрдВрдЧреАред

## тЪая╕П рд╕реБрд░рдХреНрд╖рд╛ рдиреЛрдЯ тЪая╕П

рдЧреНрд░рд╛рдл рдбреЗрдЯрд╛рдмреЗрд╕ рдкрд░ рдкреНрд░рд╢реНрди рдФрд░ рдЙрддреНрддрд░ рдкреНрд░рдгрд╛рд▓реА рдмрдирд╛рдирд╛ рдореЙрдбрд▓-рдЬрдирд┐рдд рдЧреНрд░рд╛рдл рдХреНрд╡реЗрд░реА рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИред рдРрд╕рд╛ рдХрд░рдиреЗ рдореЗрдВ рдЕрдВрддрд░реНрдирд┐рд╣рд┐рдд рдЬреЛрдЦрд┐рдо рд╣реИрдВред рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░реЗрдВ рдХрд┐ рдЖрдкрдХрд╛ рдбреЗрдЯрд╛рдмреЗрд╕ рдХрдиреЗрдХреНрд╢рди рдЕрдиреБрдорддрд┐рдпрд╛рдВ рд╣рдореЗрд╢рд╛ рдЖрдкрдХреЗ рд╢реНрд░реГрдВрдЦрд▓рд╛/рдПрдЬреЗрдВрдЯ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛рдУрдВ рдХреЗ рд▓рд┐рдП рд╕рдВрдХреАрд░реНрдг рд╣реИрдВред рдЗрд╕рд╕реЗ рдореЙрдбрд▓-рд╕рдВрдЪрд╛рд▓рд┐рдд рдкреНрд░рдгрд╛рд▓реА рдмрдирд╛рдиреЗ рдХреЗ рдЬреЛрдЦрд┐рдореЛрдВ рдХреЛ рдХрдо рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рд╣рд╛рд▓рд╛рдВрдХрд┐ рдкреВрд░реА рддрд░рд╣ рд╕реЗ рдирд╣реАрдВред рд╕рд╛рдорд╛рдиреНрдп рд╕реБрд░рдХреНрд╖рд╛ рд╕рд░реНрд╡реЛрддреНрддрдо рдкреНрд░рдерд╛рдУрдВ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП, [рдпрд╣рд╛рдВ рджреЗрдЦреЗрдВ](/docs/security)ред

## рд╡рд╛рд╕реНрддреБрдХрд▓рд╛

рдЙрдЪреНрдЪ рд╕реНрддрд░ рдкрд░, рдЕрдзрд┐рдХрд╛рдВрд╢ рдЧреНрд░рд╛рдл рд╢реНрд░реГрдВрдЦрд▓рд╛рдУрдВ рдХреЗ рдЪрд░рдг рд╣реИрдВ:

1. **рдкреНрд░рд╢реНрди рдХреЛ рдЧреНрд░рд╛рдл рдбреЗрдЯрд╛рдмреЗрд╕ рдХреНрд╡реЗрд░реА рдореЗрдВ рдкрд░рд┐рд╡рд░реНрддрд┐рдд рдХрд░рдирд╛**: рдореЙрдбрд▓ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЗрдирдкреБрдЯ рдХреЛ рдЧреНрд░рд╛рдл рдбреЗрдЯрд╛рдмреЗрд╕ рдХреНрд╡реЗрд░реА (рдЙрджрд╛. Cypher) рдореЗрдВ рдкрд░рд┐рд╡рд░реНрддрд┐рдд рдХрд░рддрд╛ рд╣реИред
2. **рдЧреНрд░рд╛рдл рдбреЗрдЯрд╛рдмреЗрд╕ рдХреНрд╡реЗрд░реА рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдирд╛**: рдЧреНрд░рд╛рдл рдбреЗрдЯрд╛рдмреЗрд╕ рдХреНрд╡реЗрд░реА рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░реЗрдВред
3. **рдкреНрд░рд╢реНрди рдХрд╛ рдЙрддреНрддрд░ рджреЗрдирд╛**: рдореЙрдбрд▓ рдХреНрд╡реЗрд░реА рдкрд░рд┐рдгрд╛рдореЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЗрдирдкреБрдЯ рдХрд╛ рдЙрддреНрддрд░ рджреЗрддрд╛ рд╣реИред

![sql_usecase.png](../../../../../../static/img/graph_usecase.png)

## рд╕реЗрдЯрдЕрдк

рдкрд╣рд▓реЗ, рдЖрд╡рд╢реНрдпрдХ рдкреИрдХреЗрдЬ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ рдФрд░ рд╡рд╛рддрд╛рд╡рд░рдг рдЪрд░ рд╕реЗрдЯ рдХрд░реЗрдВред
рдЗрд╕ рдЙрджрд╛рд╣рд░рдг рдореЗрдВ, рд╣рдо Neo4j рдЧреНрд░рд╛рдл рдбреЗрдЯрд╛рдмреЗрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВрдЧреЗред

```python
%pip install --upgrade --quiet  langchain langchain-community langchain-openai neo4j
```

рд╣рдо рдЗрд╕ рдЧрд╛рдЗрдб рдореЗрдВ OpenAI рдореЙрдбрд▓ рдХрд╛ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВред

```python
import getpass
import os

os.environ["OPENAI_API_KEY"] = getpass.getpass()

# Uncomment the below to use LangSmith. Not required.
# os.environ["LANGCHAIN_API_KEY"] = getpass.getpass()
# os.environ["LANGCHAIN_TRACING_V2"] = "true"
```

```output
 ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖
```

рдЕрдм, рд╣рдореЗрдВ Neo4j рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓ рдХреЛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред
рдПрдХ Neo4j рдбреЗрдЯрд╛рдмреЗрд╕ рд╕реЗрдЯ рдЕрдк рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП [рдЗрди рд╕реНрдерд╛рдкрдирд╛ рдЪрд░рдгреЛрдВ](https://neo4j.com/docs/operations-manual/current/installation/) рдХрд╛ рдкрд╛рд▓рди рдХрд░реЗрдВред

```python
os.environ["NEO4J_URI"] = "bolt://localhost:7687"
os.environ["NEO4J_USERNAME"] = "neo4j"
os.environ["NEO4J_PASSWORD"] = "password"
```

рдиреАрдЪреЗ рдХрд╛ рдЙрджрд╛рд╣рд░рдг рдПрдХ Neo4j рдбреЗрдЯрд╛рдмреЗрд╕ рдХреЗ рд╕рд╛рде рдХрдиреЗрдХреНрд╢рди рдмрдирд╛рдПрдЧрд╛ рдФрд░ рдлрд┐рд▓реНрдореЛрдВ рдФрд░ рдЙрдирдХреЗ рдЕрднрд┐рдиреЗрддрд╛рдУрдВ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЙрджрд╛рд╣рд░рдг рдбреЗрдЯрд╛ рд╕реЗ рднрд░реЗрдЧрд╛ред

```python
from langchain_community.graphs import Neo4jGraph

graph = Neo4jGraph()

# Import movie information

movies_query = """
LOAD CSV WITH HEADERS FROM
'https://raw.githubusercontent.com/tomasonjo/blog-datasets/main/movies/movies_small.csv'
AS row
MERGE (m:Movie {id:row.movieId})
SET m.released = date(row.released),
    m.title = row.title,
    m.imdbRating = toFloat(row.imdbRating)
FOREACH (director in split(row.director, '|') |
    MERGE (p:Person {name:trim(director)})
    MERGE (p)-[:DIRECTED]->(m))
FOREACH (actor in split(row.actors, '|') |
    MERGE (p:Person {name:trim(actor)})
    MERGE (p)-[:ACTED_IN]->(m))
FOREACH (genre in split(row.genres, '|') |
    MERGE (g:Genre {name:trim(genre)})
    MERGE (m)-[:IN_GENRE]->(g))
"""

graph.query(movies_query)
```

```output
[]
```

## рдЧреНрд░рд╛рдл рд╕реНрдХреАрдорд╛

рдПрдХ LLM рдХреЛ Cypher рдмрдпрд╛рди рдЬрдирд░реЗрдЯ рдХрд░рдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рд╣реЛрдиреЗ рдХреЗ рд▓рд┐рдП, рдЙрд╕реЗ рдЧреНрд░рд╛рдл рд╕реНрдХреАрдорд╛ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЬрд╛рдирдХрд╛рд░реА рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИред рдЬрдм рдЖрдк рдПрдХ рдЧреНрд░рд╛рдл рдСрдмреНрдЬреЗрдХреНрдЯ рдЗрдВрд╕реНрдЯреИрдВрд╢рд┐рдПрдЯ рдХрд░рддреЗ рд╣реИрдВ, рддреЛ рдпрд╣ рдЧреНрд░рд╛рдл рд╕реНрдХреАрдорд╛ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЬрд╛рдирдХрд╛рд░реА рдкреНрд░рд╛рдкреНрдд рдХрд░рддрд╛ рд╣реИред рдпрджрд┐ рдЖрдк рдмрд╛рдж рдореЗрдВ рдЧреНрд░рд╛рдл рдореЗрдВ рдХреЛрдИ рдкрд░рд┐рд╡рд░реНрддрди рдХрд░рддреЗ рд╣реИрдВ, рддреЛ рдЖрдк `refresh_schema` рд╡рд┐рдзрд┐ рдХреЛ рдЪрд▓рд╛рдХрд░ рд╕реНрдХреАрдорд╛ рдЬрд╛рдирдХрд╛рд░реА рдХреЛ рддрд╛рдЬрд╝рд╛ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

```python
graph.refresh_schema()
print(graph.schema)
```

```output
Node properties are the following:
Movie {imdbRating: FLOAT, id: STRING, released: DATE, title: STRING},Person {name: STRING},Genre {name: STRING},Chunk {id: STRING, question: STRING, query: STRING, text: STRING, embedding: LIST}
Relationship properties are the following:

The relationships are the following:
(:Movie)-[:IN_GENRE]->(:Genre),(:Person)-[:DIRECTED]->(:Movie),(:Person)-[:ACTED_IN]->(:Movie)
```

рдмрдврд╝рд┐рдпрд╛! рд╣рдорд╛рд░реЗ рдкрд╛рд╕ рдПрдХ рдРрд╕рд╛ рдЧреНрд░рд╛рдл рдбреЗрдЯрд╛рдмреЗрд╕ рд╣реИ рдЬрд┐рд╕реЗ рд╣рдо рдХреНрд╡реЗрд░реА рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдЕрдм рдЗрд╕реЗ рдПрдХ LLM рд╕реЗ рдЬреЛрдбрд╝рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░рддреЗ рд╣реИрдВред

## рд╢реНрд░реГрдВрдЦрд▓рд╛

рдЪрд▓рд┐рдП рдПрдХ рд╕рд░рд▓ рд╢реНрд░реГрдВрдЦрд▓рд╛ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВ рдЬреЛ рдПрдХ рдкреНрд░рд╢реНрди рд▓реЗрддрд╛ рд╣реИ, рдЗрд╕реЗ Cypher рдХреНрд╡реЗрд░реА рдореЗрдВ рдмрджрд▓рддрд╛ рд╣реИ, рдХреНрд╡реЗрд░реА рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рддрд╛ рд╣реИ, рдФрд░ рдореВрд▓ рдкреНрд░рд╢реНрди рдХрд╛ рдЙрддреНрддрд░ рджреЗрдиреЗ рдХреЗ рд▓рд┐рдП рдкрд░рд┐рдгрд╛рдо рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИред

![graph_chain.webp](../../../../../../static/img/graph_chain.webp)

LangChain рдореЗрдВ рдЗрд╕ рдХрд╛рд░реНрдпрдкреНрд░рд╡рд╛рд╣ рдХреЗ рд▓рд┐рдП рдПрдХ рдмрд┐рд▓реНрдЯ-рдЗрди рд╢реНрд░реГрдВрдЦрд▓рд╛ рд╣реИ рдЬреЛ Neo4j рдХреЗ рд╕рд╛рде рдХрд╛рдо рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдбрд┐рдЬрд╝рд╛рдЗрди рдХреА рдЧрдИ рд╣реИ: [GraphCypherQAChain](/docs/integrations/graphs/neo4j_cypher)

```python
from langchain.chains import GraphCypherQAChain
from langchain_openai import ChatOpenAI

llm = ChatOpenAI(model="gpt-3.5-turbo", temperature=0)
chain = GraphCypherQAChain.from_llm(graph=graph, llm=llm, verbose=True)
response = chain.invoke({"query": "What was the cast of the Casino?"})
response
```

```output


[1m> Entering new GraphCypherQAChain chain...[0m
Generated Cypher:
[32;1m[1;3mMATCH (:Movie {title: "Casino"})<-[:ACTED_IN]-(actor:Person)
RETURN actor.name[0m
Full Context:
[32;1m[1;3m[{'actor.name': 'Joe Pesci'}, {'actor.name': 'Robert De Niro'}, {'actor.name': 'Sharon Stone'}, {'actor.name': 'James Woods'}][0m

[1m> Finished chain.[0m
```

```output
{'query': 'What was the cast of the Casino?',
 'result': 'The cast of Casino included Joe Pesci, Robert De Niro, Sharon Stone, and James Woods.'}
```

# рд╕рдВрдмрдВрдз рджрд┐рд╢рд╛ рдХреА рдкреБрд╖реНрдЯрд┐

LLM рдЬрдирд░реЗрдЯ рдХрд┐рдП рдЧрдП Cypher рдмрдпрд╛рди рдореЗрдВ рд╕рдВрдмрдВрдз рджрд┐рд╢рд╛рдУрдВ рдХреЗ рд╕рд╛рде рд╕рдВрдШрд░реНрд╖ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдЪреВрдВрдХрд┐ рдЧреНрд░рд╛рдл рд╕реНрдХреАрдорд╛ рдкреВрд░реНрд╡-рдкрд░рд┐рднрд╛рд╖рд┐рдд рд╣реИ, рдЗрд╕рд▓рд┐рдП рд╣рдо `validate_cypher` рдкреИрд░рд╛рдореАрдЯрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЬрдирд░реЗрдЯ рдХрд┐рдП рдЧрдП Cypher рдмрдпрд╛рдиреЛрдВ рдореЗрдВ рд╕рдВрдмрдВрдз рджрд┐рд╢рд╛рдУрдВ рдХреА рдкреБрд╖реНрдЯрд┐ рдФрд░ рд╡реИрдХрд▓реНрдкрд┐рдХ рд░реВрдк рд╕реЗ рд╕реБрдзрд╛рд░ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

```python
chain = GraphCypherQAChain.from_llm(
    graph=graph, llm=llm, verbose=True, validate_cypher=True
)
response = chain.invoke({"query": "What was the cast of the Casino?"})
response
```

```output


[1m> Entering new GraphCypherQAChain chain...[0m
Generated Cypher:
[32;1m[1;3mMATCH (:Movie {title: "Casino"})<-[:ACTED_IN]-(actor:Person)
RETURN actor.name[0m
Full Context:
[32;1m[1;3m[{'actor.name': 'Joe Pesci'}, {'actor.name': 'Robert De Niro'}, {'actor.name': 'Sharon Stone'}, {'actor.name': 'James Woods'}][0m

[1m> Finished chain.[0m
```

```output
{'query': 'What was the cast of the Casino?',
 'result': 'The cast of Casino included Joe Pesci, Robert De Niro, Sharon Stone, and James Woods.'}
```

### рдЕрдЧрд▓реЗ рдХрджрдо

рдЕрдзрд┐рдХ рдЬрдЯрд┐рд▓ рдХреНрд╡реЗрд░реА-рдЬрдирд░реЗрд╢рди рдХреЗ рд▓рд┐рдП, рд╣рдо рдХреБрдЫ рд╢реЙрдЯ рдкреНрд░реЛрдореНрдкреНрдЯ рдпрд╛ рдХреНрд╡реЗрд░реА-рдЬрд╛рдВрдЪ рдЪрд░рдг рдЬреЛрдбрд╝рдирд╛ рдЪрд╛рд╣ рд╕рдХрддреЗ рд╣реИрдВред рдЗрд╕ рддрд░рд╣ рдХреЗ рдЙрдиреНрдирдд рддрдХрдиреАрдХреЛрдВ рдФрд░ рдЕрдзрд┐рдХ рдХреЗ рд▓рд┐рдП рджреЗрдЦреЗрдВ:

* [рдкреНрд░реЛрдореНрдкреНрдЯрд┐рдВрдЧ рд░рдгрдиреАрддрд┐рдпрд╛рдВ](/docs/use_cases/graph/prompting): рдЙрдиреНрдирдд рдкреНрд░реЛрдореНрдкреНрдЯ рдЗрдВрдЬреАрдирд┐рдпрд░рд┐рдВрдЧ рддрдХрдиреАрдХреЗрдВред
* [рдореВрд▓реНрдпреЛрдВ рдХреЛ рдореИрдк рдХрд░рдирд╛](/docs/use_cases/graph/mapping): рдкреНрд░рд╢реНрдиреЛрдВ рд╕реЗ рдбреЗрдЯрд╛рдмреЗрд╕ рдореЗрдВ рдореВрд▓реНрдпреЛрдВ рдХреЛ рдореИрдк рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рддрдХрдиреАрдХреЗрдВред
* [рд╕реЗрдорд╛рдВрдЯрд┐рдХ рдкрд░рдд](/docs/use_cases/graph/semantic): рд╕реЗрдорд╛рдВрдЯрд┐рдХ рдкрд░рддреЛрдВ рдХреЛ рд▓рд╛рдЧреВ рдХрд░рдиреЗ рдХреА рддрдХрдиреАрдХреЗрдВред
* [рдЧреНрд░рд╛рдл рдХрд╛ рдирд┐рд░реНрдорд╛рдг](/docs/use_cases/graph/constructing): рдЬреНрдЮрд╛рди рдЧреНрд░рд╛рдл рдХрд╛ рдирд┐рд░реНрдорд╛рдг рдХрд░рдиреЗ рдХреА рддрдХрдиреАрдХреЗрдВред
