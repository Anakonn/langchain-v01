---
translated: true
---

# рдЗрдВрдЯреЗрд▓ рдЬрд╝реАрдСрди рдкрд░ рдЖрд░рдПрдЬреА рдЙрджрд╛рд╣рд░рдг

рдпрд╣ рдЯреЗрдореНрдкрд▓реЗрдЯ рдЗрдВрдЯреЗрд▓┬о рдЬрд╝реАрдСрди┬о рд╕реНрдХреЗрд▓реЗрдмрд▓ рдкреНрд░реЛрд╕реЗрд╕рд░ рдкрд░ рдХреНрд░реЛрдорд╛ рдФрд░ рдЯреЗрдХреНрд╕реНрдЯ рдЬрдирд░реЗрд╢рди рдЗрдиреНрдлрд░реЗрдВрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЖрд░рдПрдЬреА рдХрд░рддрд╛ рд╣реИред
рдЗрдВрдЯреЗрд▓┬о рдЬрд╝реАрдСрди┬о рд╕реНрдХреЗрд▓реЗрдмрд▓ рдкреНрд░реЛрд╕реЗрд╕рд░ рдЕрдзрд┐рдХ рдкреНрд░рджрд░реНрд╢рди-рдкреНрд░рддрд┐-рдХреЛрд░ рдФрд░ рдЕрддреБрд▓рдиреАрдп рдПрдЖрдИ рдкреНрд░рджрд░реНрд╢рди рдХреЗ рд▓рд┐рдП рдмрд┐рд▓реНрдЯ-рдЗрди рдПрдХреНрд╕реЗрд▓реЗрд░реЗрдЯрд░реНрд╕ рдХреА рд╡рд┐рд╢реЗрд╖рддрд╛ рд░рдЦрддреЗ рд╣реИрдВ, рд╕рдмрд╕реЗ рдЕрдзрд┐рдХ рдорд╛рдВрдЧ рд╡рд╛рд▓реЗ рд╡рд░реНрдХрд▓реЛрдб рдЖрд╡рд╢реНрдпрдХрддрд╛рдУрдВ рдХреЗ рд▓рд┐рдП рдЙрдиреНрдирдд рд╕реБрд░рдХреНрд╖рд╛ рддрдХрдиреАрдХреЛрдВ рдХреЗ рд╕рд╛рде- рд╕рднреА рдЬрдмрдХрд┐ рд╕рдмрд╕реЗ рдмрдбрд╝рд╛ рдХреНрд▓рд╛рдЙрдб рд╡рд┐рдХрд▓реНрдк рдФрд░ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдкреЛрд░реНрдЯреЗрдмрд┐рд▓рд┐рдЯреА рдкреНрд░рджрд╛рди рдХрд░рддреЗ рд╣реИрдВ, рдХреГрдкрдпрд╛ рджреЗрдЦреЗрдВ [Intel┬о Xeon┬о Scalable Processors](https://www.intel.com/content/www/us/en/products/details/processors/xeon/scalable.html)ред

## рдкрд░реНрдпрд╛рд╡рд░рдг рд╕реЗрдЯрдЕрдк

рдЗрдВрдЯреЗрд▓┬о рдЬрд╝реАрдСрди┬о рд╕реНрдХреЗрд▓реЗрдмрд▓ рдкреНрд░реЛрд╕реЗрд╕рд░ рдкрд░ [ЁЯдЧ text-generation-inference](https://github.com/huggingface/text-generation-inference) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдХреГрдкрдпрд╛ рдЗрди рдЪрд░рдгреЛрдВ рдХрд╛ рдкрд╛рд▓рди рдХрд░реЗрдВ:

### рдЗрдВрдЯреЗрд▓ рдЬрд╝реАрдСрди рд╕рд░реНрд╡рд░ рдкрд░ рдПрдХ рд╕реНрдерд╛рдиреАрдп рд╕рд░реНрд╡рд░ рдЗрдВрд╕реНрдЯреЗрдВрд╕ рд▓реЙрдиреНрдЪ рдХрд░реЗрдВ:

```bash
model=Intel/neural-chat-7b-v3-3
volume=$PWD/data # share a volume with the Docker container to avoid downloading weights every run

docker run --shm-size 1g -p 8080:80 -v $volume:/data ghcr.io/huggingface/text-generation-inference:1.4 --model-id $model
```

рдЧреЗрдЯреЗрдб рдореЙрдбрд▓ рдЬреИрд╕реЗ `LLAMA-2` рдХреЗ рд▓рд┐рдП, рдЖрдкрдХреЛ рдПрдХ рд╡реИрдз рд╣рдЧрд┐рдВрдЧ рдлреЗрд╕ рд╣рдм рдкрдврд╝рдиреЗ рд╡рд╛рд▓реЗ рдЯреЛрдХрди рдХреЗ рд╕рд╛рде рдЙрдкрд░реЛрдХреНрдд рдбреЙрдХрд░ рд░рди рдХрдорд╛рдВрдб рдХреЛ -e HUGGING_FACE_HUB_TOKEN=\<token\> рдкрд╛рд╕ рдХрд░рдирд╛ рд╣реЛрдЧрд╛ред

рдХреГрдкрдпрд╛ рдЗрд╕ рд▓рд┐рдВрдХ рдХрд╛ рдкрд╛рд▓рди рдХрд░реЗрдВ [huggingface token](https://huggingface.co/docs/hub/security-tokens) рдЯреЛрдХрди рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдФрд░ рдЯреЛрдХрди рдХреЗ рд╕рд╛рде `HUGGINGFACEHUB_API_TOKEN` рдкрд░реНрдпрд╛рд╡рд░рдг рдХреЛ рдирд┐рд░реНрдпрд╛рдд рдХрд░реЗрдВред

```bash
export HUGGINGFACEHUB_API_TOKEN=<token>
```

рдЬрд╛рдВрдЪрдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдЕрдиреБрд░реЛрдз рднреЗрдЬреЗрдВ рдХрд┐ рдХреНрдпрд╛ рдПрдВрдбрдкреЙрдЗрдВрдЯ рдХрд╛рдо рдХрд░ рд░рд╣рд╛ рд╣реИ:

```bash
curl localhost:8080/generate -X POST -d '{"inputs":"Which NFL team won the Super Bowl in the 2010 season?","parameters":{"max_new_tokens":128, "do_sample": true}}'   -H 'Content-Type: application/json'
```

рдЕрдзрд┐рдХ рд╡рд┐рд╡рд░рдг рдХреЗ рд▓рд┐рдП рдХреГрдкрдпрд╛ рджреЗрдЦреЗрдВ [text-generation-inference](https://github.com/huggingface/text-generation-inference)ред

## рдбреЗрдЯрд╛ рдХреЗ рд╕рд╛рде рдкреЙрдкреБрд▓реЗрдЯ рдХрд░рдирд╛

рдпрджрд┐ рдЖрдк рдХреБрдЫ рдЙрджрд╛рд╣рд░рдг рдбреЗрдЯрд╛ рдХреЗ рд╕рд╛рде DB рдХреЛ рдкреЙрдкреБрд▓реЗрдЯ рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ, рддреЛ рдЖрдк рдиреАрдЪреЗ рджрд┐рдП рдЧрдП рдХрдорд╛рдВрдб рдЪрд▓рд╛ рд╕рдХрддреЗ рд╣реИрдВ:

```shell
poetry install
poetry run python ingest.py
```

рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдкреНрд░реЛрд╕реЗрд╕ рдФрд░ рдПрдбрдЧрд░ 10k рдлрд╛рдЗрд▓рд┐рдВрдЧ рдбреЗрдЯрд╛ рд╕реЗ рдирд╛рдЗрдХреА `nke-10k-2023.pdf` рдХреЗ рд╕реЗрдХреНрд╢рди рдХреЛ рдХреНрд░реЛрдорд╛ рдбреЗрдЯрд╛рдмреЗрд╕ рдореЗрдВ рд╕реНрдЯреЛрд░ рдХрд░рддрд╛ рд╣реИред

## рдЙрдкрдпреЛрдЧ

рдЗрд╕ рдкреИрдХреЗрдЬ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдЖрдкрдХреЗ рдкрд╛рд╕ рдкрд╣рд▓реЗ рд╕реЗ LangChain CLI рдЗрдВрд╕реНрдЯреЙрд▓ рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП:

```shell
pip install -U langchain-cli
```

рдПрдХ рдирдпрд╛ LangChain рдкреНрд░реЛрдЬреЗрдХреНрдЯ рдмрдирд╛рдиреЗ рдФрд░ рдЗрд╕реЗ рдХреЗрд╡рд▓ рдкреИрдХреЗрдЬ рдХреЗ рд░реВрдк рдореЗрдВ рдЗрдВрд╕реНрдЯреЙрд▓ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдЖрдк рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:

```shell
langchain app new my-app --package intel-rag-xeon
```

рдпрджрд┐ рдЖрдк рдЗрд╕реЗ рдПрдХ рдореМрдЬреВрджрд╛ рдкреНрд░реЛрдЬреЗрдХреНрдЯ рдореЗрдВ рдЬреЛрдбрд╝рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ, рддреЛ рдЖрдк рдмрд╕ рдЪрд▓рд╛ рд╕рдХрддреЗ рд╣реИрдВ:

```shell
langchain app add intel-rag-xeon
```

рдФрд░ рдЕрдкрдиреЗ `server.py` рдлрд╝рд╛рдЗрд▓ рдореЗрдВ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХреЛрдб рдЬреЛрдбрд╝реЗрдВ:

```python
from intel_rag_xeon import chain as xeon_rag_chain

add_routes(app, xeon_rag_chain, path="/intel-rag-xeon")
```

(рд╡реИрдХрд▓реНрдкрд┐рдХ) рдЕрдм рдЖрдЗрдП LangSmith рдХреЛ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд░реЗрдВред LangSmith рд╣рдореЗрдВ LangChain рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЛ рдЯреНрд░реЗрд╕, рдореЙрдирд┐рдЯрд░ рдФрд░ рдбрд┐рдмрдЧ рдХрд░рдиреЗ рдореЗрдВ рдорджрдж рдХрд░реЗрдЧрд╛ред рдЖрдк LangSmith рдХреЗ рд▓рд┐рдП [рдпрд╣рд╛рдВ](https://smith.langchain.com/) рд╕рд╛рдЗрди рдЕрдк рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдпрджрд┐ рдЖрдкрдХреЗ рдкрд╛рд╕ рдкрд╣реБрдВрдЪ рдирд╣реАрдВ рд╣реИ, рддреЛ рдЖрдк рдЗрд╕ рд╕реЗрдХреНрд╢рди рдХреЛ рдЫреЛрдбрд╝ рд╕рдХрддреЗ рд╣реИрдВред

```shell
export LANGCHAIN_TRACING_V2=true
export LANGCHAIN_API_KEY=<your-api-key>
export LANGCHAIN_PROJECT=<your-project>  # if not specified, defaults to "default"
```

рдпрджрд┐ рдЖрдк рдЗрд╕ рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдХреЗ рдЕрдВрджрд░ рд╣реИрдВ, рддреЛ рдЖрдк рд╕реАрдзреЗ рдПрдХ LangServe рдЗрдВрд╕реНрдЯреЗрдВрд╕ рд╕реНрдкрд┐рди рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:

```shell
langchain serve
```

рдпрд╣ рдПрдХ рд╕реНрдерд╛рдиреАрдп рд░реВрдк рд╕реЗ рдЪрд▓ рд░рд╣реЗ рд╕рд░реНрд╡рд░ рдХреЗ рд╕рд╛рде FastAPI рдРрдк рдХреЛ рд╢реБрд░реВ рдХрд░реЗрдЧрд╛
[http://localhost:8000](http://localhost:8000) рдкрд░

рд╣рдо рд╕рднреА рдЯреЗрдореНрдкрд▓реЗрдЯреНрд╕ [http://127.0.0.1:8000/docs](http://127.0.0.1:8000/docs) рдкрд░ рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ
рд╣рдо рдкреНрд▓реЗрдЧреНрд░рд╛рдЙрдВрдб рдХреЛ [http://127.0.0.1:8000/intel-rag-xeon/playground](http://127.0.0.1:8000/intel-rag-xeon/playground) рдкрд░ рдПрдХреНрд╕реЗрд╕ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ

рд╣рдо рдХреЛрдб рд╕реЗ рдЯреЗрдореНрдкрд▓реЗрдЯ рдХреЛ рдПрдХреНрд╕реЗрд╕ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:

```python
from langserve.client import RemoteRunnable

runnable = RemoteRunnable("http://localhost:8000/intel-rag-xeon")
```
